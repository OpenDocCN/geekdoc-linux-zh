- en: Debug builds
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 调试构建
- en: When we speak of *debug builds*, we usually refer to curl builds that are done
    with debug code and symbols still present. We strongly recommend you do this if
    you want to work with curl development as it makes it easier to test and debug.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 当我们提到 *调试构建* 时，通常指的是带有调试代码和符号的 curl 构建。我们强烈建议您这样做，如果您想与 curl 开发工作，因为它使得测试和调试变得更加容易。
- en: 'You make a debug build using configure like this:'
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用如下方式使用 configure 来进行调试构建：
- en: '[PRE0]'
  id: totrans-3
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Debug-builds make it possible to run individual test cases with gdb with runtests.pl,
    which is handy - especially for example if you can make it crash somewhere as
    then gdb can catch it and show you exactly where it happens etc.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 runtests.pl，调试构建可以运行单个测试用例，并与 gdb 一起使用，这很方便——例如，如果您能让它崩溃在某处，那么 gdb 可以捕获它并显示它发生的确切位置等。
- en: Debug-builds are also built a little different than regular *release builds*
    in that they contain some snippets of code that makes curl easier to test. For
    example it allows the test suite to override the random number generator so that
    testing for values that otherwise are random actually work. Also, the unit tests
    only work on debug builds.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 与常规 *发布构建* 相比，调试构建有一些不同的构建方式，其中包含一些使 curl 更容易测试的代码片段。例如，它允许测试套件覆盖随机数生成器，以便测试那些在其他情况下是随机的值实际上可以工作。此外，单元测试仅在调试构建上运行。
- en: Memdebug
  id: totrans-6
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Memdebug
- en: Debug builds also enable the *memdebug* internal memory tracking and debugging
    system.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 调试构建还启用了 *memdebug* 内部内存跟踪和调试系统。
- en: When switched on, the memdebug system outputs detailed information about a lot
    of memory-related options into a logfile, so that it can be analyzed and verified
    after the fact. Verified that all memory was freed, all files were closed and
    so on.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 当启用时，memdebug 系统会将大量与内存相关的选项的详细信息输出到日志文件中，以便事后进行分析和验证。验证所有内存都已释放，所有文件都已关闭等。
- en: This is a poor-man’s version of valgrind but does not at all compare with its
    features. It is however fairly portable and low-impact.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个简化的 valgrind 版本，但它的功能远不如 valgrind。然而，它相当便携且影响较小。
- en: In a debug build, the memdebug system is enabled by curl if the `CURL_MEMDEBUG`
    environment variable is set to a filename, which is used for the log. The test
    suite sets this variable for us (see `tests/log/memdump`) and verifies it after
    each test run, if present.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 在调试构建中，如果将 `CURL_MEMDEBUG` 环境变量设置为文件名，curl 会启用 memdebug 系统进行内存调试。测试套件会为我们设置此变量（参见
    `tests/log/memdump`），并在每次测试运行后验证它（如果存在）。
