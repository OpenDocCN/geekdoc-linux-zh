- en: Appendix J. An Introduction to Programmable Completion
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 附录 J. 可编程完成简介
- en: 原文：[https://tldp.org/LDP/abs/html/tabexpansion.html](https://tldp.org/LDP/abs/html/tabexpansion.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://tldp.org/LDP/abs/html/tabexpansion.html](https://tldp.org/LDP/abs/html/tabexpansion.html)
- en: The *programmable completion* feature in Bash permits typing a partial command,
    then pressing the **[Tab]** key to auto-complete the command sequence. [[1]](#FTN.AEN24082)
    If multiple completions are possible, then **[Tab]** lists them all. Let's see
    how it works.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: Bash 中的 *可编程完成* 功能允许输入部分命令，然后按**[Tab]**键来自动完成命令序列。[[1]](#FTN.AEN24082) 如果有多个完成选项，则**[Tab]**键会列出所有选项。让我们看看它是如何工作的。
- en: '|  [PRE0]  |'
  id: totrans-3
  prefs: []
  type: TYPE_TB
  zh: '|  [PRE0]  |'
- en: Tab completion also works for variables and path names.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 制表符完成也适用于变量和路径名。
- en: '|  [PRE1]  |'
  id: totrans-5
  prefs: []
  type: TYPE_TB
  zh: '|  [PRE1]  |'
- en: The Bash **complete** and **compgen** [builtins](internal.html#BUILTINREF) make
    it possible for *tab completion* to recognize partial *parameters* and *options*
    to commands. In a very simple case, we can use **complete** from the command-line
    to specify a short list of acceptable parameters.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: Bash 的 **complete** 和 **compgen** [内置命令](internal.html#BUILTINREF) 使得 *制表符完成*
    能够识别命令的部分 *参数* 和 *选项*。在非常简单的情况下，我们可以使用命令行的 **complete** 来指定一组可接受的参数。
- en: '|  [PRE2]  |'
  id: totrans-7
  prefs: []
  type: TYPE_TB
  zh: '|  [PRE2]  |'
- en: The `-f` option to *complete* specifies filenames, and `-X` the filter pattern.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '`-f` 选项用于 *complete* 指定文件名，而 `-X` 用于过滤模式。'
- en: For anything more complex, we could write a script that specifies a list of
    acceptable command-line parameters. The **compgen** builtin expands a list of
    *arguments* to *generate* completion matches.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 对于更复杂的情况，我们可以编写一个脚本，指定一组可接受的命令行参数。**compgen** 内置命令将一组 *参数* 扩展为 *生成* 完成匹配。
- en: Let us take a [modified version](contributed-scripts.html#USEGETOPT2) of the
    *UseGetOpt.sh* script as an example command. This script accepts a number of command-line
    parameters, preceded by either a single or double dash. And here is the corresponding
    *completion script*, by convention given a filename corresponding to its associated
    command.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们以 *UseGetOpt.sh* 脚本的 [修改版本](contributed-scripts.html#USEGETOPT2) 作为示例命令。此脚本接受一系列命令行参数，这些参数前面可以是单个或双破折号。这里是对应的
    *完成脚本*，按照惯例，文件名与相关命令相对应。
- en: '**Example J-1\. Completion script for *UseGetOpt.sh***'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: '**示例 J-1\. 为 *UseGetOpt.sh* 编写的完成脚本***'
- en: '|  [PRE3]  |'
  id: totrans-12
  prefs: []
  type: TYPE_TB
  zh: '|  [PRE3]  |'
- en: Now, let's try it.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，让我们试试。
- en: '|  [PRE4]  |'
  id: totrans-14
  prefs: []
  type: TYPE_TB
  zh: '|  [PRE4]  |'
- en: We begin by [sourcing](internal.html#SOURCEREF) the "completion script." This
    sets the command-line parameters. [[2]](#FTN.AEN24160)
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 我们首先通过 [source](internal.html#SOURCEREF) “完成脚本”。这设置了命令行参数。[[2]](#FTN.AEN24160)
- en: In the first instance, hitting **[Tab]** after a single dash, the output is
    all the possible parameters preceded by *one or more* dashes. Hitting **[Tab]**
    after *two* dashes gives the possible parameters preceded by *two or more* dashes.
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 首先，在单个破折号后按**[Tab]**键，输出的是所有可能的参数，前面带有一个或多个破折号。在两个破折号后按**[Tab]**键，则输出的是前面带有两个或更多破折号的参数。
- en: Now, just what is the point of having to jump through flaming hoops to enable
    command-line tab completion? *It saves keystrokes.* [[3]](#FTN.AEN24173)
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 现在，为什么要费尽周折去启用命令行的制表符完成功能呢？*它节省了按键次数。[[3]](#FTN.AEN24173)
- en: --
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: --
- en: '*Resources:*'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '*资源：*'
- en: Bash [programmable completion](http://freshmeat.net/projects/bashcompletion)
    project
  id: totrans-20
  prefs: []
  type: TYPE_NORMAL
  zh: Bash [可编程完成](http://freshmeat.net/projects/bashcompletion) 项目
- en: Mitch Frazier's [*Linux Journal*](http://www.linuxjournal.com) article, [*More
    on Using the Bash Complete Command*](http://www.linuxjournal.com/content/more-using-bash-complete-command)
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 米奇·弗雷泽的 [*Linux Journal*](http://www.linuxjournal.com) 文章，[*关于使用 Bash Complete
    命令的更多内容*](http://www.linuxjournal.com/content/more-using-bash-complete-command)
- en: 'Steve''s excellent two-part article, "An Introduction to Bash Completion":
    [Part 1](http://www.debian-administration.org/article/An_introduction_to_bash_completion_part_1)
    and [Part 2](http://www.debian-administration.org/article/An_introduction_to_bash_completion_part_2)'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 史蒂夫出色的两篇系列文章，“Bash 完成功能简介”：[第一部分](http://www.debian-administration.org/article/An_introduction_to_bash_completion_part_1)
    和 [第二部分](http://www.debian-administration.org/article/An_introduction_to_bash_completion_part_2)
- en: Notes
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: 注意事项
- en: '| [[1]](tabexpansion.html#AEN24082) | This works only from the *command line*,
    of course, and not within a script. |'
  id: totrans-24
  prefs: []
  type: TYPE_TB
  zh: '| [[1]](tabexpansion.html#AEN24082) | 这当然只适用于 *命令行*，而不适用于脚本内部。|'
- en: '| [[2]](tabexpansion.html#AEN24160) | Normally the default parameter completion
    files reside in either the `/etc/profile.d` directory or in `/etc/bash_completion`.
    These autoload on system startup. So, after writing a useful completion script,
    you might wish to move it (as *root*, of course) to one of these directories.
    |'
  id: totrans-25
  prefs: []
  type: TYPE_TB
  zh: '| [[2]](tabexpansion.html#AEN24160) | 通常，默认参数补全文件位于 `/etc/profile.d` 目录或 `/etc/bash_completion`
    目录中。这些文件在系统启动时自动加载。因此，在编写一个有用的补全脚本后，你可能希望将其（当然，作为 *root* 用户）移动到这些目录之一。 |'
- en: '| [[3]](tabexpansion.html#AEN24173) | It has been extensively documented that
    programmers are willing to put in long hours of effort in order to save ten minutes
    of "unnecessary" labor. This is known as *optimization*. |'
  id: totrans-26
  prefs: []
  type: TYPE_TB
  zh: '| [[3]](tabexpansion.html#AEN24173) | 已有大量文献记载，程序员愿意投入长时间的努力以节省十分钟“不必要的”劳动。这被称为
    *优化*。 |'
