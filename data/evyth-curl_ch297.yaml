- en: Windows vs Unix
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Windows 与 Unix
- en: 'There are a few differences in how to program curl the Unix way compared to
    the Windows way. Perhaps the four most notable details are:'
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 与 Windows 方式相比，Unix 方式编程 curl 存在一些差异。可能最显著的四个细节是：
- en: Different function names for socket operations
  id: totrans-2
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 套接字操作的不同函数名
- en: In curl, this is solved with defines and macros, so that the source looks the
    same in all places except for the header file that defines them. The macros in
    use are `sclose()`, `sread()` and `swrite()`.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在 curl 中，这是通过定义和宏来解决的，因此除了定义它们的头文件之外，源代码在所有地方看起来都是一样的。使用的宏是 `sclose()`、`sread()`
    和 `swrite()`。
- en: Init calls
  id: totrans-4
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 初始化调用
- en: Windows requires a couple of init calls for the socket stuff.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: Windows 需要对套接字进行几个初始化调用。
- en: That is taken care of by the `curl_global_init()` call, but if other libs also
    do it etc there might be reasons for applications to alter that behavior.
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 这由 `curl_global_init()` 调用处理，但如果其他库也这样做等，可能存在应用程序需要改变该行为的原因。
- en: We require WinSock version 2.2 and load this version during global init.
  id: totrans-7
  prefs: []
  type: TYPE_NORMAL
  zh: 我们需要 WinSock 版本 2.2，并在全局初始化期间加载此版本。
- en: File descriptors
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 文件描述符
- en: File descriptors for network communication and file operations are not as easily
    interchangeable as in Unix.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 网络通信和文件操作的文件描述符不像在 Unix 中那样容易互换。
- en: We avoid this by not trying any funny tricks on file descriptors.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 我们通过不在文件描述符上尝试任何奇怪技巧来避免这种情况。
- en: Stdout
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 标准输出
- en: When writing data to stdout, Windows makes end-of-lines the DOS way, thus destroying
    binary data, although you do want that conversion if it is text coming through…
    (sigh)
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 当向标准输出写入数据时，Windows 会以 DOS 方式处理行结束符，从而破坏二进制数据，尽管如果你处理的是文本数据，你可能希望进行这种转换……（叹息）
- en: We set stdout to binary under windows
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Windows 下，我们将标准输出设置为二进制
- en: Ifdefs
  id: totrans-14
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: Ifdefs
- en: Inside the source code, We make an effort to avoid `#ifdef [Your OS]`. All conditionals
    that deal with features *should* instead be in the format `#ifdef HAVE_THAT_WEIRD_FUNCTION`.
    Since Windows cannot run configure scripts, we maintain a `curl_config-win32.h`
    file in the lib directory that is supposed to look exactly like a `curl_config.h`
    file would have looked like on a Windows machine.
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 在源代码内部，我们努力避免使用 `#ifdef [Your OS]`。所有处理功能的条件语句*应该*以 `#ifdef HAVE_THAT_WEIRD_FUNCTION`
    的格式出现。由于 Windows 无法运行配置脚本，我们在 lib 目录中维护一个 `curl_config-win32.h` 文件，该文件应该与 Windows
    机器上的 `curl_config.h` 文件看起来完全一样。
- en: 'Generally speaking: curl is frequently compiled on several dozens of operating
    systems. Do not walk on the edge.'
  id: totrans-16
  prefs: []
  type: TYPE_NORMAL
  zh: 一般而言：curl 经常在几十种操作系统上编译。不要走钢丝。
