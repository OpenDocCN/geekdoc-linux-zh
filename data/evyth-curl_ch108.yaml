- en: Keep alive
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Keep alive
- en: TCP connections can be totally without traffic in either direction when they
    are not used. A totally idle connection can therefore not be clearly separated
    from a connection that has gone completely stale because of network or server
    issues.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 当不使用时，TCP 连接在两个方向上都可以完全没有流量。因此，一个完全空闲的连接无法与因网络或服务器问题而完全停滞的连接明显区分开来。
- en: At the same time, lots of network equipment such as firewalls or NATs are keeping
    track of TCP connections these days, so that they can translate addresses, block
    “wrong” incoming packets, etc. These devices often count completely idle connections
    as dead after N minutes, where N varies between device to device but at times
    is as short as 10 minutes or even less.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 同时，如今许多网络设备，如防火墙或 NAT，都在跟踪 TCP 连接，以便它们可以转换地址、阻止“错误”的传入数据包等。这些设备通常在 N 分钟后将完全空闲的连接视为已死亡，其中
    N 在不同设备之间有所不同，有时短至 10 分钟甚至更少。
- en: One way to help avoid a really slow connection (or an idle one) getting treated
    as dead and wrongly killed, is to make sure TCP keep alive is used. TCP keepalive
    is a feature in the TCP protocol that makes it send “ping frames” back and forth
    when it would otherwise be totally idle. It helps idle connections to detect breakage
    even when no traffic is moving over it, and helps intermediate systems not consider
    the connection dead.
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 避免一个真正缓慢的连接（或一个空闲的连接）被错误地视为已死亡并错误地终止的一种方法，是确保使用 TCP keepalive。TCP keepalive
    是 TCP 协议中的一个功能，它在其他情况下完全空闲时会发送“ping frames”来回。它帮助空闲连接检测到断开，即使在没有任何流量通过它的情况下，也帮助中间系统不认为连接已死亡。
- en: 'curl uses TCP keepalive by default for the reasons mentioned here. But there
    might be times when you want to *disable* keepalive or you may want to change
    the interval between the TCP “pings” (curl defaults to 60 seconds). You can switch
    off keepalive with:'
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: curl 默认使用 TCP keepalive，原因如下。但有时你可能想*禁用* keepalive，或者你可能想改变 TCP “ping” 之间的间隔（curl
    默认为 60 秒）。你可以通过以下方式关闭 keepalive：
- en: '[PRE0]'
  id: totrans-5
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'or change the interval to 5 minutes (300 seconds) with:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 或者将间隔改为 5 分钟（300 秒）：
- en: '[PRE1]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
