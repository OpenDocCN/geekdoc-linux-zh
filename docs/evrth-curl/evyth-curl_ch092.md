# 我的浏览器显示的内容不同

一个常见的用例是使用 curl 获取你可以在浏览器地址栏粘贴的 URL。

浏览器在获取 URL 作为输入时，比 curl 做得多得多，并且以多种不同的方式，因此 curl 在终端输出中显示的内容可能与你浏览器窗口中看到的内容完全不同。

## 客户端差异

Curl 只会获取你要求它获取的内容，它永远不会解析服务器实际提供的数据——即数据。浏览器获取数据后，它会根据认为获取的内容类型激活不同的解析器。例如，如果数据是 HTML，它会解析它以显示网页，并可能下载其他子资源，如图片、JavaScript 和 CSS 文件。当 curl 下载 HTML 时，它只获取那个单一的 HTML 资源，即使当它被浏览器解析时，可能会触发更多的下载。如果你想让 curl 下载任何子资源，你需要将这些 URL 传递给 curl，并要求它获取这些资源，就像其他任何 URL 一样。

客户端在发送请求的方式上也有所不同，一个资源请求的一些方面包括，例如，格式偏好、请求压缩数据，或者只是告诉服务器我们是从哪个页面“来”的。curl 的请求与你的浏览器发送请求的方式略有不同或有很大不同。

## 服务器差异

接收请求并交付数据的服务器通常根据它认为与之通信的客户端类型而设置成以某种方式行动。有时它可能只是试图为客户端提供最佳内容，有时可能是为了某些客户端隐藏一些内容，甚至试图绕过特定浏览器中已知的问题。当然，还有各种登录系统，可能依赖于 HTTP 身份验证、cookies 或客户端来自预验证的 IP 地址范围。

有时，使用 curl 从服务器获取与浏览器获取相同的响应实际上非常困难。用户通常会使用浏览器的网络工具记录他们的浏览器会话，然后将该记录与 curl 的`--trace-ascii`选项记录的数据进行比较，然后修改 curl 的请求（通常使用`-H`/`--header`），直到服务器开始对两者做出相同的响应。

这类工作可能既耗时又繁琐。你应该始终在服务器所有者或管理员许可的情况下进行。

## 中间件的篡改

中间件是代理，可以是显式的也可以是隐式的。某些环境强制你使用一个，或者你可能出于各种原因选择使用一个，但还有一些透明的中间件会静默地拦截你的网络流量并为你代理，无论你想要什么。

代理是“中间人”，它们终止流量，然后代表你向远程服务器进行操作。这可能会引入各种显式的过滤，并“拯救”你免受某些内容的影响，甚至“保护”远程服务器免受你试图发送给它的数据，但更重要的是，它引入了另一种软件对协议如何工作以及正确做法的看法。

干扰的中介往往是导致许多头痛和神秘现象的原因，甚至包括对内容进行直接的恶意修改。

我们强烈建议您使用 HTTPS 或其他方式来验证您下载或上传的内容确实是远程服务器发送给您的数据，并且您的宝贵字节最终完整地到达了预期的目的地。
