# 协议

用于请求数据发送（无论是哪个方向）的语言被称为**协议**。协议精确地描述了如何请求服务器提供数据，或者告诉服务器有数据即将到来。

协议通常由 IETF（[互联网工程任务组](https://www.ietf.org/)）定义，它托管 RFC 文档，这些文档精确地描述了每个协议的工作方式：客户端和服务器应该如何行动，应该发送什么等等。

## curl 支持哪些协议？

curl 支持允许数据在任一方向或两个方向上传输的协议。我们通常也限制自己使用那些在 RFC 中有 URI 格式描述或至少是某种广泛使用的协议，因为 curl 主要使用 URL（URI）作为输入键来指定传输。

本文中提到的最新版本的 curl（截至撰写本文时）支持以下协议：

DICT, FILE, FTP, FTPS, GOPHER, GOPHERS, HTTP, HTTPS, IMAP, IMAPS, LDAP, LDAPS, MQTT, POP3, POP3S, RTMP, RTSP, SCP, SFTP, SMB, SMBS, SMTP, SMTPS, TELNET, TFTP, WS, WSS

更进一步地复杂化，这些协议通常存在不同的版本或风味。

## 还有哪些其他协议？

世界充满了协议，既有旧的也有新的。旧协议被废弃和淘汰，新协议被引入。永远没有稳定的状态，但情况每天都在变化，每年都在变化。你可以放心，未来将在上述列表中添加新的协议，并且现有协议也将有新的版本。

当然，已经存在其他一些 curl 尚未支持的协议。我们愿意支持更多适合 curl 通用范例的协议，我们只需要开发者为他们编写必要的代码调整即可。

## 协议是如何开发的？

新版本现有协议和全新的协议通常是由那些认为现有协议不够好的人或团队开发的。它们的一些特性使它们不适合特定的用例，或者可能有一些新想法可以应用于改进事物。

当然，没有人阻止任何人完全按照自己的意愿在自己的后院开发一个协议，但主要协议通常在早期就带到 IETF，在那里它们被讨论、完善、辩论和润色，然后最终，理想情况下，被转化为发布的 RFC 文档。

软件开发者然后阅读 RFC 规范，并根据他们对这些文件中文字的解释在世界范围内部署他们的代码。有时会出现一些规范有非常不同的解释，或者工程师只是懒惰，忽略了规范中的合理建议，部署了一些不符合规范的东西。因此，编写与规范的其他实现互操作性的软件可能是一项艰巨的工作。

## 协议变化有多大？

就像软件一样，协议规范经常更新，并且会创建新的协议版本。

大多数协议都允许一定程度的可扩展性，这使得新的扩展随着时间的推移出现，这些扩展是有意义并值得支持的。

即使规范保持不变，协议的解释有时也会发生变化。

本章中提到的协议都是**应用协议**，这意味着它们通过更底层的协议（如 TCP、UDP 和 TLS）进行传输。它们本身也是随时间变化、获得新功能和受到攻击的协议，这迫使 curl 适应和改变，以处理新的安全方式等。

## 关于遵守标准和谁是对的

通常，有一些协议规范告诉我们如何为特定协议发送和接收数据。我们遵循的协议规范是由 IETF 汇编和发布的 RFC。

有些协议在最终的 RFC 中没有得到适当的文档记录，例如，我们的实现基于一个甚至不是最新版本的 Internet-draft 的 SFTP。

然而，协议是由双方讨论的，就像在任何对话中一样，理解某事或解释规范中的给定指令都有两个理解方面。此外，许多网络软件的编写者没有仔细关注规范，所以他们最终采取了捷径，或者他们可能只是对文本有不同的解释。有时甚至错误和漏洞会导致软件以规范未规定甚至规范中明确禁止的方式运行。

在 curl 项目中，我们使用已发布的规范作为行动规则，直到我们了解其他情况。如果流行的替代实现的行为与我们认为的规范不同，并且这种替代行为在互联网上广泛使用，那么我们改变脚步并决定像其他人一样行动的可能性很大。如果我们认为我们遵循了规范但服务器拒绝与我们交谈，而当我们将规则稍微弯曲时却可以正常工作，那么我们可能最终会以那种方式弯曲规则——如果我们仍然可以与其他实现成功工作的话。

最终，这是一个个人决定，在我们认为规范和现实世界不一致的每个情况下都值得讨论。

在最坏的情况下，我们引入选项，让应用程序开发者和 curl 用户对 curl 应该做什么有最终决定权。我说最坏，因为通常很难要求用户做出这些决定，因为这通常涉及到棘手的细节和奇怪的情况，这对用户来说要求很高。我们应该始终尽力避免将此类协议决策推给用户。
