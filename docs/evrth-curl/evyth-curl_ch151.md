# HTTP/3

HTTP/3 在几个方面与其前辈不同。最明显的是，HTTP/3 不能像 HTTP/2 那样在相同的连接上进行协商。由于 HTTP/3 使用不同的传输协议，它必须为它设置和协商一个专用的连接。

## QUIC

HTTP/3 是专为在 QUIC 上通信而设计的 HTTP 版本。对于大多数特定目的而言，QUIC 可以被视为 TCP+TLS 的替代品。

因此，所有使用 HTTP/3 的传输都不使用 TCP。它们使用 QUIC。QUIC 是在 UDP 上构建的可靠传输协议。HTTP/3 意味着使用 QUIC。

## HTTPS 仅限

HTTP/3 是在 QUIC 上执行的，QUIC 始终使用 TLS，因此 HTTP/3 在定义上始终是加密和安全的。因此，curl 仅对`HTTPS://` URL 使用 HTTP/3。

## 启用

作为直接访问 HTTP/3 的快捷方式，要使 curl 尝试直接连接到给定的主机名和端口号进行 QUIC 连接，请使用`--http3`。如下所示：

```sh
curl --http3 https://example.com/
```

通常，如果没有`--http3`选项，`HTTPS://` URL 意味着客户端需要使用 TCP（和 TLS）连接到它。

## 复用

HTTP/3 协议的一个主要特性是能够在相同的物理连接上复用多个逻辑流。curl 命令行工具可以在进行并行传输时利用这一特性。

## Alt-svc:

将 HTTP/3 切换为 alt-svc 的方法是服务器启动 HTTP/3 的官方方式。

注意，你需要该功能内置，并且它不会为*当前*请求切换到 HTTP/3，除非 alt-svc 缓存已经填充，但它而不是存储信息以供在*下一个*请求到该主机时使用。

## 当 QUIC 被拒绝

由于许多网络和主机阻止或限制流量，一定数量的 QUIC 连接尝试会失败。

当使用`--http3`时，curl 在启动 QUIC 连接后大约几百毫秒开始第二次传输尝试，该连接使用 HTTP/2 或 HTTP/1，这样如果 QUIC 连接尝试失败或变得无法忍受地慢，使用较旧 HTTP 版本的连接仍然可以成功并执行传输。这使用户可以有一定信心地使用`--http3`。

`--http3-only`选项用于明确*不*尝试任何较旧版本并行传输，但因此如果无法建立 QUIC 连接，传输将立即失败。
