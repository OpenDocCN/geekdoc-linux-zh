# 疯狂

当 curl 构建时启用调试，它提供了一种特殊的测试类型。我们称之为**疯狂**测试。不用担心，它并不像听起来那么可怕。

它们验证 libcurl 和 curl 的退出路径在没有发生任何崩溃或内存泄漏的情况下工作，

疯狂测试是这样工作的：

+   首先以原样运行单个测试

+   计算调用次数的*可失败*函数数量

+   为每个下降函数调用重新运行一次测试

+   逐个使每个可失败函数调用返回错误

+   验证没有泄漏或崩溃

+   继续直到所有可失败函数都失败

这种测试方式可能需要非常长的时间。我建议你在尝试时关闭 Valgrind。

## 重新运行特定的失败测试

如果单个测试失败，`runtests.pl`会精确识别触发问题的“轮次”，并通过使用如所示`-t`选项，你可以运行一个命令行，当调用时只会失败那个特定的可失败函数。

## 浅层

为了使这种测试方式更加实用，测试套件还提供了一个`--shallow`选项。这允许用户为每个测试案例设置最大可失败函数的数量。如果失败调用多于这个值，脚本将随机选择哪些函数失败。

作为一项特殊功能，由于在测试中随机化事物可能会感到不舒服，脚本使用基于年份加月份的随机种子，因此对于每个月历月份都是相同的。方便得很，如果你用相同的`--shallow`值重新运行相同的测试，它将运行相同的随机测试。

你可以使用 runtests 的`--seed`选项强制使用不同的种子。
