# 压缩

curl 允许你请求 HTTP 和 HTTPS 服务器提供压缩后的数据，并在到达时自动解压缩。在带宽比 CPU 更有限的情况下，这可以帮助你在更短的时间内接收更多数据。

HTTP 压缩可以使用两种不同的机制来完成，一种可能被认为是“正确的方式”，另一种则是大家实际使用且广泛流行的方式。压缩 HTTP 内容的一种常见方式是使用**内容编码**头。你要求 curl 使用这个选项`--compressed`：

```sh
curl --compressed http://example.com/
```

启用此选项（如果服务器支持）后，它会以压缩方式提供数据，curl 在保存或发送到 stdout 之前对其进行解压缩。这通常意味着作为用户，你实际上并不真正看到或体验到压缩，除非可能注意到传输速度更快。

`--compressed`选项请求使用支持的压缩算法之一进行内容编码压缩。还有一种罕见的**传输编码**方法，这是为这种自动化方法创建的请求头，但从未真正广泛采用。你可以告诉 curl 使用`--tr-encoding`请求传输编码压缩：

```sh
curl --tr-encoding http://example.com/
```

理论上，没有什么是阻止你在同一命令行中使用两者的，尽管在实践中，你可能发现当被要求以两种不同的方式压缩时，某些服务器会有些困惑。通常来说，只选择一种更安全。

对于 SCP 和 SFTP 传输，有`--compressed-ssh`选项。它会在两个方向上压缩所有流量。

## HTTP 头部

HTTP/1.x 的头部不能被压缩。另一方面，HTTP/2 和 HTTP/3 的头部总是被压缩，并且不能以未压缩的形式发送。然而，为了方便用户，curl 总是以类似于 HTTP/1.x 的风格显示未压缩的头部，以使输出看起来一致。

## 上传

对于 HTTP，没有标准的压缩方式。上述提到的 HTTP 压缩方法仅适用于下载。
