# Windows 与 Unix

与 Windows 方式相比，Unix 方式编程 curl 存在一些差异。可能最显著的四个细节是：

## 套接字操作的不同函数名

在 curl 中，这是通过定义和宏来解决的，因此除了定义它们的头文件之外，源代码在所有地方看起来都是一样的。使用的宏是 `sclose()`、`sread()` 和 `swrite()`。

## 初始化调用

Windows 需要对套接字进行几个初始化调用。

这由 `curl_global_init()` 调用处理，但如果其他库也这样做等，可能存在应用程序需要改变该行为的原因。

我们需要 WinSock 版本 2.2，并在全局初始化期间加载此版本。

## 文件描述符

网络通信和文件操作的文件描述符不像在 Unix 中那样容易互换。

我们通过不在文件描述符上尝试任何奇怪技巧来避免这种情况。

## 标准输出

当向标准输出写入数据时，Windows 会以 DOS 方式处理行结束符，从而破坏二进制数据，尽管如果你处理的是文本数据，你可能希望进行这种转换……（叹息）

在 Windows 下，我们将标准输出设置为二进制

## Ifdefs

在源代码内部，我们努力避免使用 `#ifdef [Your OS]`。所有处理功能的条件语句*应该*以 `#ifdef HAVE_THAT_WEIRD_FUNCTION` 的格式出现。由于 Windows 无法运行配置脚本，我们在 lib 目录中维护一个 `curl_config-win32.h` 文件，该文件应该与 Windows 机器上的 `curl_config.h` 文件看起来完全一样。

一般而言：curl 经常在几十种操作系统上编译。不要走钢丝。
