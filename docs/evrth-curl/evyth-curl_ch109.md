# 超时

网络操作由于其本质上是相当不可靠或可能脆弱的操作，因为它们依赖于一系列服务和网络保持运行，以便事物能够正常工作。这些服务的可用性可能会来去，它们的性能也可能随时有很大变化。

TCP 的设计甚至允许网络在一段较长的时间内完全断开连接，而无需参与者注意到这一点。

结果是，有时互联网传输需要很长时间。此外，curl 中的大多数操作默认没有超时。

## 允许花费的最大时间

使用 `-m / --max-time` 告诉 curl 允许命令行花费的最大时间（以秒为单位），在 curl 退出并带有超时错误代码（28）之前。当设置的时间经过后，curl 将退出，无论当时正在发生什么——包括如果它正在传输数据。这真的是允许的最大时间。

给定的最大时间可以用小数精度指定；`0.5` 表示 500 毫秒，而 `2.37` 等于 2370 毫秒。

示例：

```sh
curl --max-time 5.5 https://example.com/
```

（您的区域可能使用除点号以外的其他符号来表示数值分数。）

## 永远不要花费超过这个时间来连接

`--connect-timeout` 限制了 curl 尝试连接到主机的时间。在连接被视为完成之前，所有必要的步骤都必须在给定的时间框架内完成。如果在给定时间内无法连接，curl 将退出并带有超时退出代码（28）。

在连接被视为成功之前完成的步骤包括 DNS 查找和随后的 TCP、TLS 或 QUIC 握手。

给定的最大连接时间可以用小数精度指定；`0.5` 表示 500 毫秒，而 `2.37` 等于 2370 毫秒：

```sh
curl --connect-timeout 2.37 https://example.com/
```
