# 网络简化

网络意味着在互联网上的两个端点之间进行通信。互联网只是一堆相互连接的机器（实际上是计算机），每个机器使用自己的独立地址（称为[IP 地址](https://en.wikipedia.org/wiki/IP_address)）。每台机器的地址可以是不同类型的，机器甚至可以有临时地址。这些计算机也被称为主机。

## 客户端和服务器

你坐在前面的电脑、平板或手机通常被称为*客户端*，而你想要与之交换数据的远端机器被称为*服务器*。客户端和服务器之间的主要区别在于它们扮演的角色。在后续操作中，这些角色被反转是没有什么的。

转换请求总是由客户端发起的，因为服务器无法联系客户端，但客户端可以联系服务器。

## 哪台机器

当我们作为客户端想要从那里的一台机器（服务器）发起传输或向其传输时，我们通常不知道它的 IP 地址，而是知道它的名称。我们想要与之通信的机器的名称通常嵌入在我们使用 curl 或浏览器等工具工作时处理的 URL 中。

我们可能会使用一个像 `http://example.com/index.html` 这样的 URL，这意味着客户端连接到并与名为 example.com 的主机进行通信。

## 主机名解析

一旦客户端知道了主机名，它需要找出具有该名称的主机有哪些 IP 地址，以便能够联系它。

将名称转换为 IP 地址的过程称为“名称解析”。该名称被*解析*为一个或一组地址。这通常由一个*DNS 服务器*来完成，DNS 就像一个大型的查找表，可以将名称转换为地址——实际上，是互联网上的所有名称。计算机通常已经知道运行 DNS 服务器的计算机的地址，因为这是网络设置的一部分。

因此，网络客户端会向 DNS 服务器请求，“你好，请给我所有`example.com`的地址”。DNS 服务器会回应一个地址列表。或者，如果出现拼写错误，它可以回应说该名称不存在。

## 建立连接

对于客户端想要联系的主机，它有一个或多个 IP 地址，它会发送一个*连接请求*。它想要建立的连接被称为 TCP ([传输控制协议](https://en.wikipedia.org/wiki/Transmission_Control_Protocol)) 或 [QUIC](https://en.wikipedia.org/wiki/QUIC) 连接，这就像在两台计算机之间连接一根无形的线。一旦建立，这根线就可以用来在两个方向上发送数据流。

如果客户端为该主机收到了多个地址，它在连接时会遍历该地址列表，如果其中一个地址失败，它会尝试连接到下一个地址，重复此过程，直到找到一个有效的地址或所有地址都失败。

## 连接到端口号

当使用 TCP 或 QUIC 连接到远程服务器时，客户端会选择在哪个端口号上进行连接。端口号只是为特定服务预留的专用位置，允许同一服务器在相同时间内监听其他端口号上的其他服务。

大多数常见的协议都有客户端和服务器使用的默认端口号。例如，当使用`http://example.com/index.html` URL 时，该 URL 指定了一个名为`HTTP`的方案，告诉客户端它应该默认尝试服务器上的 TCP 端口号 80。如果 URL 使用`HTTPS`，则默认端口号为 443。

URL 可以包含自定义端口号。如果没有指定端口号，客户端将使用 URL 中使用的方案的默认端口号。

## 安全性

在 TCP 连接建立之后，许多传输需要在继续之前双方协商一个更好的安全级别（例如，如果使用`HTTPS`），这是通过 TLS（[传输层安全性](https://en.wikipedia.org/wiki/Transport_Layer_Security)）完成的。如果是这样，客户端和服务器首先进行 TLS 握手，只有在成功之后才会继续。

如果连接使用 QUIC 完成，TLS 握手将在连接阶段自动进行。

## 传输数据

当连接的隐喻性*字符串*连接到远程计算机时，两台机器之间就建立了*连接*。然后可以使用这个连接来交换数据。这种交换是通过*协议*完成的，如下一章所述。

传统上，*下载*是指数据从服务器传输到客户端；相反，*上传*是指数据从客户端发送到服务器。客户端在这里；服务器在那里。

## 断开连接

当单个传输完成时，连接可能已经完成了它的用途。然后它可以被重新用于进一步的传输，或者可以断开并关闭。
