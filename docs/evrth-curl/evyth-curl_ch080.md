# 详细模式

如果您的 curl 命令没有执行或返回您期望的结果，您应该首先本能地运行带有`-v / --verbose`选项的命令以获取更多信息。

当启用详细模式时，curl 变得更加健谈，并解释和显示更多它的行为。它添加了信息性测试，并以‘*’作为前缀。例如，让我们看看 curl 在尝试一个简单的 HTTP 示例（将下载的数据保存到名为“saved”的文件中）时可能会说什么：

```sh
$ curl -v http://example.com -o saved
* Rebuilt URL to: http://example.com/
```

好吧，所以我们使用了一个 curl 认为不完整的 URL 来调用它，因此它帮助我们并在继续之前添加了一个尾随斜杠。

```sh
*   Trying 93.184.216.34...
```

这告诉我们 curl 现在正在尝试连接到这个 IP 地址。这意味着域名‘example.com’已经被解析为一个或多个地址，这是 curl 尝试连接的第一个（也可能是唯一的）地址。

```sh
* Connected to example.com (93.184.216.34) port 80 (#0)
```

这成功了。curl 连接到了该网站，这里它解释了域名如何映射到 IP 地址，以及它在哪个端口上连接。‘(#0)’部分是 curl 为这个连接分配的内部编号。如果您在同一个命令行中尝试多个 URL，您可以看到它使用更多的连接或重用连接，因此连接计数器可能会增加或不会增加，这取决于 curl 决定需要做什么。

如果我们使用`HTTPS://` URL 而不是 HTTP URL，还会有很多行解释 curl 如何使用 CA 证书来验证服务器的证书，以及服务器证书的一些细节等。包括选择了哪些加密套件以及更多的 TLS 细节。

除了从 curl 内部获取的附加信息外，`-v`详细模式还会显示 curl 发送和接收的所有头部信息。对于没有头部信息的协议（如 FTP、SMTP、POP3 等），我们可以将命令和响应视为头部信息，因此它们也会在`-v`模式下显示。

如果我们继续查看上述命令的输出（但忽略实际的 HTML 响应），curl 会显示：

```sh
> GET / HTTP/1.1
> Host: example.com
> User-Agent: curl/7.45.0
> Accept: */*
>
```

这是发送到网站的完整 HTTP 请求。这个请求是在默认的 curl 7.45.0 安装中看起来是什么样子，当然，在不同的版本之间可能会有所不同，特别是如果您添加了命令行选项，它会有所变化。

HTTP 请求头部的最后一行看起来是空的，确实是空的。它标志着头部和主体的分隔，在这个请求中，没有“主体”要发送。

继续进行，并假设一切按计划进行，发送的请求会从服务器获得相应的响应，而这个 HTTP 响应在响应体之前开始，包含一组头部信息：

```sh
< HTTP/1.1 200 OK
< Accept-Ranges: bytes
< Cache-Control: max-age=604800
< Content-Type: text/html
< Date: Sat, 19 Dec 2015 22:01:03 GMT
< Etag: "359670651"
< Expires: Sat, 26 Dec 2015 22:01:03 GMT
< Last-Modified: Fri, 09 Aug 2013 23:54:35 GMT
< Server: ECS (ewr/15BD)
< Vary: Accept-Encoding
< X-Cache: HIT
< x-ec-custom-error: 1
< Content-Length: 1270
<
```

这可能看起来像是胡言乱语，但这是一组正常的 HTTP 头部信息——关于响应的元数据。第一行的“200”可能是其中最重要的信息，意味着“一切正常”。

收到的头部信息的最后一行，如您所见，是空的，这是 HTTP 协议用来表示头部信息结束的标记。

在头部信息之后是实际的响应体，数据负载。常规的 -v verbose 模式不会显示这些数据，但它只会显示

```sh
{ [1270 bytes data]
```

那么应该有 1270 字节在“已保存”的文件中。你还可以看到响应中有一个名为 Content-Length: 的头部，其中包含确切的文件长度（尽管它可能并不总是出现在响应中）。

## HTTP/2 和 HTTP/3

当使用 HTTP 协议的第二版或第三版进行文件传输时，curl 会发送和接收**压缩**的头部信息。为了以可读和易懂的方式显示 HTTP/2 和 HTTP/3 的头部信息，curl 会以类似于 HTTP/1.1 的风格显示未压缩的版本。

## 寂静

与 verbose 相反，当然是要让 curl 更加安静。使用 `-s`（或 `--silent`）选项可以让 curl 关闭进度条，并且在发生错误时不会输出任何错误信息。它会变得沉默。但它仍然会输出你请求下载的数据。

在激活了寂静模式后，你可以通过添加 `-S` 或 `--show-error` 来请求在失败时仍然输出错误信息。

+   跟踪选项

+   输出内容
