- en: Sorting Stuff
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://learnbyexample.github.io/cli-computing/sorting-stuff.html](https://learnbyexample.github.io/cli-computing/sorting-stuff.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: In this chapter, you'll learn how to sort input based on various criteria. And
    then, you'll learn about tools that typically require sorted input for performing
    operations like finding unique entries, comparing two files line wise and so on.
  prefs: []
  type: TYPE_NORMAL
- en: '![info](../Images/147d5d96e6e103c258c8b5f99e9505a9.png) The [example_files](https://github.com/learnbyexample/cli-computing/tree/master/example_files)
    directory has the sample input files used in this chapter.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[sort](#sort)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: As the name implies, this command is used to sort the contents of input files.
    Alphabetic sort and numeric sort? Possible. How about sorting a particular column?
    Possible. Prioritized multiple sorting order? Possible. Randomize? Unique? Lots
    of features supported by this powerful command.
  prefs: []
  type: TYPE_NORMAL
- en: '[Common options](#common-options)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Commonly used options are shown below. Examples will be discussed in the later
    sections.
  prefs: []
  type: TYPE_NORMAL
- en: '`-n` sort numerically'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-g` general numeric sort'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-V` version sort (aware of numbers within text)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-h` sort human readable numbers (ex: 4K, 3M, 12G, etc)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-k` sort via key (column sorting)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-t` single byte character as the field separator (default is non-blank to
    blank transition)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-u` sort uniquely'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-R` random sort'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-r` reverse the sort output'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-o` redirect sorted result to a specified filename (ex: for inplace sorting)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Default sort](#default-sort)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: By default, `sort` orders the input [lexicographically](https://en.wikipedia.org/wiki/Lexicographic_order)
    in ascending order. You can use the `-r` option to reverse the results.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: '![info](../Images/147d5d96e6e103c258c8b5f99e9505a9.png) Use the `-f` option
    if you want to ignore case. See also [coreutils FAQ: Sort does not sort in normal
    order!](https://www.gnu.org/software/coreutils/faq/#Sort-does-not-sort-in-normal-order_0021).'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[Numerical sort](#numerical-sort)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'There are several ways to deal with input containing different kind of numbers:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '[Unique sort](#unique-sort)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The `-u` option will keep only the first copy of lines that are deemed to be
    equal.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '[Column sort](#column-sort)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The `-k` option allows you to sort based on specific columns instead of the
    entire input line. By default, the empty string between non-blank and blank characters
    is considered as the separator. This option accepts arguments in various ways.
    You can specify starting and ending column numbers separated by a comma. If you
    specify only the starting column, the last column will be used as the ending column.
    Usually you just want to sort by a single column, in which case the same number
    is specified as both the starting and ending columns. Here''s an example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: '![info](../Images/147d5d96e6e103c258c8b5f99e9505a9.png) You can use the `-t`
    option to specify a single byte character as the field separator. Use `\0` to
    specify ASCII NUL as the separator.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '![info](../Images/147d5d96e6e103c258c8b5f99e9505a9.png) Use the `-s` option
    to retain the original order of input lines when two or more lines are deemed
    equal. You can still use multiple keys to specify your own tie breakers, `-s`
    only prevents the last resort comparison.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[uniq](#uniq)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: This command helps you to identify and remove duplicates. Usually used with
    sorted inputs as the comparison is made between adjacent lines only.
  prefs: []
  type: TYPE_NORMAL
- en: '[Common options](#common-options-1)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: Commonly used options are shown below. Examples will be discussed in the later
    sections.
  prefs: []
  type: TYPE_NORMAL
- en: '`-u` display only the unique entries'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-d` display only the duplicate entries'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-D` display all the copies of duplicates'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-c` prefix count'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-i` ignore case while determining duplicates'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-f` skip the first `N` fields (separator is space/tab characters)'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-s` skip the first `N` characters'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-w` restricts the comparison to the first `N` characters'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[Default uniq](#default-uniq)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'By default, `uniq` retains only one copy of duplicate lines:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '[Unique and duplicate entries](#unique-and-duplicate-entries)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: The `-u` option will display only the unique entries. That is, only if a line
    doesn't occur more than once.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: The `-d` option will display only the duplicate entries. That is, only if a
    line is seen more than once. To display all the copies of duplicates, use the
    `-D` option.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[Prefix count](#prefix-count)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: If you want to know how many times a line has been repeated, use the `-c` option.
    This will be added as a prefix.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: '[Partial match](#partial-match)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: '`uniq` has three options to change the matching criteria to partial parts of
    the input line. These aren''t as powerful as the `sort -k` option, but they do
    come in handy for some use cases.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '[comm](#comm)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: 'The `comm` command finds common and unique lines between two sorted files.
    By default, you''ll get a tabular output with three columns:'
  prefs: []
  type: TYPE_NORMAL
- en: first column has lines unique to the first file
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: second column has lines unique to the second file
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: third column has lines common to both the files
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: 'You can use one or more of the following options to suppress columns:'
  prefs: []
  type: TYPE_NORMAL
- en: '`-1` to suppress lines unique to the first file'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-2` to suppress lines unique to the second file'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`-3` to suppress lines common to both the files'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs: []
  type: TYPE_PRE
- en: '[join](#join)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: By default, the `join` command combines two files based on the first field content
    (also referred as **key**). Only the lines with common keys will be part of the
    output.
  prefs: []
  type: TYPE_NORMAL
- en: The key field will be displayed first in the output (this distinction will come
    into play if the first field isn't the key). Rest of the line will have the remaining
    fields from the first and second files, in that order. One or more blanks (space
    or tab) will be considered as the input field separator and a single space will
    be used as the output field separator. If present, blank characters at the start
    of the input lines will be ignored.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE11]'
  prefs: []
  type: TYPE_PRE
- en: '![info](../Images/147d5d96e6e103c258c8b5f99e9505a9.png) Note that the collating
    order used for `join` should be same as the one used to `sort` the input files.
    Use `join -i` to ignore case, similar to `sort -f` usage.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: If a field value is present multiple times in the same input file, all possible
    combinations will be present in the output. As shown below, `join` will also ensure
    to add a final newline character even if not present in the input.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE12]'
  prefs: []
  type: TYPE_PRE
- en: '![info](../Images/147d5d96e6e103c258c8b5f99e9505a9.png) There are many more
    features such as specifying field delimiter, selecting specific fields from each
    input file in a particular order, filling fields for non-matching lines and so
    on. See the [join chapter](https://learnbyexample.github.io/cli_text_processing_coreutils/join.html)
    from my [CLI text processing with GNU Coreutils](https://github.com/learnbyexample/cli_text_processing_coreutils)
    ebook for explanations and examples.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[Exercises](#exercises)'
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
- en: '![info](../Images/147d5d96e6e103c258c8b5f99e9505a9.png) Use the [example_files/text_files](https://github.com/learnbyexample/cli-computing/tree/master/example_files/text_files)
    directory for input files used in the following exercises.'
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '**1)** Default `sort` doesn''t work for numbers. Correct the command used below:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]'
  prefs: []
  type: TYPE_PRE
- en: '**2)** Which `sort` option will help you ignore case?'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE14]'
  prefs: []
  type: TYPE_PRE
- en: '**3)** Go through the `sort` manual and use appropriate options to get the
    output shown below.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE15]'
  prefs: []
  type: TYPE_PRE
- en: '**4)** Sort the `scores.csv` file numerically in ascending order using the
    contents of the second field. Header line should be preserved as the first line
    as shown below. *Hint*: see the [Shell Features](./shell-features.html) chapter.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE16]'
  prefs: []
  type: TYPE_PRE
- en: '**5)** Sort the contents of `duplicates.txt` by the fourth column numbers in
    descending order. Retain only the first copy of lines with the same number.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE17]'
  prefs: []
  type: TYPE_PRE
- en: '**6)** Will `uniq` throw an error if the input is not sorted? What do you think
    will be the output for the following input?'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE18]'
  prefs: []
  type: TYPE_PRE
- en: '**7)** Retain only the unique entries based on the first two characters of
    the input lines. Sort the input if necessary.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE19]'
  prefs: []
  type: TYPE_PRE
- en: '**8)** Count the number of times input lines are repeated and display the results
    in the format shown below.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE20]'
  prefs: []
  type: TYPE_PRE
- en: '**9)** Display lines present in `c1.txt` but not in `c2.txt` using the `comm`
    command. Assume that the input files are already sorted.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE21]'
  prefs: []
  type: TYPE_PRE
- en: '**10)** Use appropriate options to get the expected output shown below.'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE22]'
  prefs: []
  type: TYPE_PRE
- en: '**11)** What are the differences between `sort -u` and `uniq -u` options, if
    any?'
  prefs: []
  type: TYPE_NORMAL
