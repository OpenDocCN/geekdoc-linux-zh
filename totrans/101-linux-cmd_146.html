<html><head></head><body>
    <div style="page-break-after: always;"/>
    <h1>The <code>ufw</code> command</h1>
    <p>UFW (Uncomplicated Firewall) is a user-friendly command-line frontend for managing iptables firewall rules on Ubuntu and other Debian-based systems. It provides a simple way to configure firewall rules without dealing with complex iptables syntax.</p>
    <h2>Syntax</h2>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash">ufw [options] <span class="hljs-built_in">command</span> [parameters]
</code>
    </pre>
    <h2>Installation</h2>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Ubuntu/Debian</span>
sudo apt update &amp;&amp; sudo apt install ufw

<span class="hljs-comment"># Check if UFW is installed</span>
<span class="hljs-built_in">which</span> ufw
</code>
    </pre>
    <h2>Basic Commands</h2>
    <h3>Enable/Disable UFW</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Enable UFW</span>
sudo ufw <span class="hljs-built_in">enable</span>

<span class="hljs-comment"># Disable UFW</span>
sudo ufw <span class="hljs-built_in">disable</span>

<span class="hljs-comment"># Check UFW status</span>
sudo ufw status
sudo ufw status verbose
sudo ufw status numbered
</code>
    </pre>
    <h2>Basic Rules</h2>
    <h3>Allow/Deny Traffic</h3>
    <ol>
      <li>
        <strong>Allow specific ports</strong>
      </li>
    </ol>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow SSH (port 22)</span>
sudo ufw allow 22
sudo ufw allow ssh

<span class="hljs-comment"># Allow HTTP (port 80)</span>
sudo ufw allow 80
sudo ufw allow http

<span class="hljs-comment"># Allow HTTPS (port 443)</span>
sudo ufw allow 443
sudo ufw allow https

<span class="hljs-comment"># Allow custom port</span>
sudo ufw allow 8080
</code>
    </pre>
    <ol start="2">
      <li>
        <strong>Deny specific ports</strong>
      </li>
    </ol>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Deny port 80</span>
sudo ufw deny 80

<span class="hljs-comment"># Deny SSH from specific IP</span>
sudo ufw deny from 192.168.1.100 to any port 22
</code>
    </pre>
    <ol start="3">
      <li>
        <strong>Allow/Deny by service name</strong>
      </li>
    </ol>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow common services</span>
sudo ufw allow ssh
sudo ufw allow http
sudo ufw allow https
sudo ufw allow ftp
sudo ufw allow smtp
</code>
    </pre>
    <h2>Advanced Rules</h2>
    <h3>Port Ranges</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow port range</span>
sudo ufw allow 1000:2000/tcp
sudo ufw allow 1000:2000/udp

<span class="hljs-comment"># Allow specific protocol</span>
sudo ufw allow 53/udp  <span class="hljs-comment"># DNS</span>
sudo ufw allow 53/tcp  <span class="hljs-comment"># DNS over TCP</span>
</code>
    </pre>
    <h3>IP Address Rules</h3>
    <ol>
      <li>
        <strong>Allow/Deny specific IP addresses</strong>
      </li>
    </ol>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow from specific IP</span>
sudo ufw allow from 192.168.1.100

<span class="hljs-comment"># Deny from specific IP</span>
sudo ufw deny from 192.168.1.50

<span class="hljs-comment"># Allow subnet</span>
sudo ufw allow from 192.168.1.0/24
</code>
    </pre>
    <ol start="2">
      <li>
        <strong>Allow IP to specific port</strong>
      </li>
    </ol>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow specific IP to SSH</span>
sudo ufw allow from 192.168.1.100 to any port 22

<span class="hljs-comment"># Allow subnet to web server</span>
sudo ufw allow from 10.0.0.0/8 to any port 80
</code>
    </pre>
    <h3>Interface-specific Rules</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow on specific interface</span>
sudo ufw allow <span class="hljs-keyword">in</span> on eth0 to any port 80

<span class="hljs-comment"># Allow out on specific interface</span>
sudo ufw allow out on eth1 to any port 443
</code>
    </pre>
    <h2>Rule Management</h2>
    <h3>List Rules</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Show status and rules</span>
sudo ufw status

<span class="hljs-comment"># Show numbered rules</span>
sudo ufw status numbered

<span class="hljs-comment"># Show verbose status</span>
sudo ufw status verbose
</code>
    </pre>
    <h3>Delete Rules</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Delete by rule number</span>
sudo ufw delete 3

<span class="hljs-comment"># Delete by specifying the rule</span>
sudo ufw delete allow 80
sudo ufw delete allow from 192.168.1.100
</code>
    </pre>
    <h3>Insert Rules</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Insert rule at specific position</span>
sudo ufw insert 1 allow from 192.168.1.0/24
</code>
    </pre>
    <h2>Default Policies</h2>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Set default policies</span>
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw default deny forward

<span class="hljs-comment"># Check current defaults</span>
sudo ufw status verbose
</code>
    </pre>
    <h2>Application Profiles</h2>
    <h3>List Available Profiles</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># List application profiles</span>
sudo ufw app list

<span class="hljs-comment"># Show profile info</span>
sudo ufw app info OpenSSH
sudo ufw app info <span class="hljs-string">"Apache Full"</span>
</code>
    </pre>
    <h3>Use Application Profiles</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow application</span>
sudo ufw allow OpenSSH
sudo ufw allow <span class="hljs-string">"Apache Full"</span>
sudo ufw allow <span class="hljs-string">"Nginx Full"</span>

<span class="hljs-comment"># Common application profiles</span>
sudo ufw allow <span class="hljs-string">"OpenSSH"</span>
sudo ufw allow <span class="hljs-string">"Apache"</span>
sudo ufw allow <span class="hljs-string">"Apache Secure"</span>
sudo ufw allow <span class="hljs-string">"Nginx HTTP"</span>
sudo ufw allow <span class="hljs-string">"Nginx HTTPS"</span>
sudo ufw allow <span class="hljs-string">"Nginx Full"</span>
</code>
    </pre>
    <h2>Logging</h2>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Enable logging</span>
sudo ufw logging on

<span class="hljs-comment"># Set log level</span>
sudo ufw logging low
sudo ufw logging medium
sudo ufw logging high

<span class="hljs-comment"># Disable logging</span>
sudo ufw logging off

<span class="hljs-comment"># View logs</span>
sudo tail -f /var/<span class="hljs-built_in">log</span>/ufw.log
</code>
    </pre>
    <h2>Reset and Reload</h2>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Reset all rules to default</span>
sudo ufw --force reset

<span class="hljs-comment"># Reload UFW</span>
sudo ufw reload
</code>
    </pre>
    <h2>Common Use Cases</h2>
    <h3>1. Basic Web Server Setup</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow SSH, HTTP, and HTTPS</span>
sudo ufw allow ssh
sudo ufw allow http
sudo ufw allow https
sudo ufw <span class="hljs-built_in">enable</span>
</code>
    </pre>
    <h3>2. Database Server (MySQL)</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow MySQL only from application servers</span>
sudo ufw allow from 192.168.1.10 to any port 3306
sudo ufw allow from 192.168.1.11 to any port 3306
</code>
    </pre>
    <h3>3. Development Server</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow common development ports</span>
sudo ufw allow 3000  <span class="hljs-comment"># Node.js</span>
sudo ufw allow 8000  <span class="hljs-comment"># Django</span>
sudo ufw allow 5000  <span class="hljs-comment"># Flask</span>
sudo ufw allow 4200  <span class="hljs-comment"># Angular</span>
</code>
    </pre>
    <h3>4. Mail Server</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow mail server ports</span>
sudo ufw allow smtp      <span class="hljs-comment"># Port 25</span>
sudo ufw allow 587/tcp   <span class="hljs-comment"># SMTP submission</span>
sudo ufw allow 993/tcp   <span class="hljs-comment"># IMAPS</span>
sudo ufw allow 995/tcp   <span class="hljs-comment"># POP3S</span>
</code>
    </pre>
    <h3>5. DNS Server</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow DNS traffic</span>
sudo ufw allow 53/tcp
sudo ufw allow 53/udp
</code>
    </pre>
    <h2>Security Best Practices</h2>
    <h3>1. Principle of Least Privilege</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Start with deny all</span>
sudo ufw default deny incoming
sudo ufw default allow outgoing

<span class="hljs-comment"># Only allow what's needed</span>
sudo ufw allow ssh
sudo ufw allow from 192.168.1.0/24 to any port 80
</code>
    </pre>
    <h3>2. Limit SSH Access</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Limit SSH attempts (6 attempts in 30 seconds)</span>
sudo ufw <span class="hljs-built_in">limit</span> ssh

<span class="hljs-comment"># Allow SSH only from specific networks</span>
sudo ufw allow from 192.168.1.0/24 to any port 22
sudo ufw deny ssh
</code>
    </pre>
    <h3>3. Monitor and Log</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Enable logging</span>
sudo ufw logging medium

<span class="hljs-comment"># Monitor logs</span>
sudo tail -f /var/<span class="hljs-built_in">log</span>/ufw.log | grep DPT
</code>
    </pre>
    <h2>Troubleshooting</h2>
    <h3>1. Check Current Rules</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash">sudo ufw status numbered
sudo iptables -L -n
</code>
    </pre>
    <h3>2. Test Connections</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Test if port is accessible</span>
telnet your-server-ip 80
nc -zv your-server-ip 22
</code>
    </pre>
    <h3>3. Debug UFW</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Dry run (show what would happen)</span>
sudo ufw --dry-run allow 80

<span class="hljs-comment"># Check UFW version</span>
ufw --version
</code>
    </pre>
    <h2>Advanced Configuration</h2>
    <h3>1. Custom Rules File</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Edit UFW rules directly</span>
sudo vim /etc/ufw/user.rules
sudo vim /etc/ufw/user6.rules
</code>
    </pre>
    <h3>2. Rate Limiting</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Limit connections per IP</span>
sudo ufw <span class="hljs-built_in">limit</span> ssh
sudo ufw <span class="hljs-built_in">limit</span> 80/tcp
</code>
    </pre>
    <h3>3. Port Forwarding</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Enable IP forwarding</span><span class="hljs-built_in">echo</span>Â <span class="hljs-string">'net.ipv4.ip_forward=1'</span> | sudo tee -a /etc/ufw/sysctl.conf

<span class="hljs-comment"># Add NAT rules to /etc/ufw/before.rules</span>
</code>
    </pre>
    <h2>Integration with Services</h2>
    <h3>1. Docker Integration</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Allow Docker containers</span>
sudo ufw allow from 172.17.0.0/16

<span class="hljs-comment"># Block Docker bypass (in /etc/ufw/after.rules)</span>
</code>
    </pre>
    <h3>2. Fail2ban Integration</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># UFW works with fail2ban</span>
sudo apt install fail2ban
<span class="hljs-comment"># Configure fail2ban to use UFW actions</span>
</code>
    </pre>
    <h2>Important Notes</h2>
    <ul>
      <li>UFW is a frontend for iptables, not a replacement</li>
      <li>Rules are processed in order (first match wins)</li>
      <li>Default policies apply when no specific rule matches</li>
      <li>UFW doesn't interfere with existing iptables rules by default</li>
      <li>Always test rules before enabling in production</li>
      <li>Keep SSH access rule before enabling UFW remotely</li>
    </ul>
    <h2>Quick Reference</h2>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Essential commands</span>
sudo ufw <span class="hljs-built_in">enable</span>                    <span class="hljs-comment"># Enable firewall</span>
sudo ufw status                    <span class="hljs-comment"># Check status</span>
sudo ufw allow 22                  <span class="hljs-comment"># Allow SSH</span>
sudo ufw allow from 192.168.1.0/24 <span class="hljs-comment"># Allow subnet</span>
sudo ufw delete 3                  <span class="hljs-comment"># Delete rule #3</span>
sudo ufw reset                     <span class="hljs-comment"># Reset all rules</span>
sudo ufw reload                    <span class="hljs-comment"># Reload configuration</span>
</code>
    </pre>
    <p>UFW provides an excellent balance between simplicity and functionality, making it ideal for system administrators who need effective firewall management without iptables complexity.</p>
    <p>For more details, check the manual: <code>man ufw</code></p>
  </body></html>