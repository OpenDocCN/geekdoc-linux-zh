<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <title>ch224.xhtml</title>
  <link rel="stylesheet" type="text/css" href="../styles/stylesheet1.css" />
</head>
<body epub:type="bodymatter">
<section id="transfers__callbacks__sshkey__md-_-_-ssh-key" class="level1" data-number="223">
<h1 data-number="223">SSH key</h1>
<p>This callback is set with <code>CURLOPT_SSH_KEYFUNCTION</code>.</p>
<p>It gets called when the <code>known_host</code> matching has been done, to allow the application to act and decide for libcurl how to proceed. The callback is called if <code>CURLOPT_SSH_KNOWNHOSTS</code> is also set.</p>
<p>In the arguments to the callback are the old key and the new key and the callback is expected to return a return code that tells libcurl how to act:</p>
<p><code>CURLKHSTAT_FINE_REPLACE</code> - The new host+key is accepted and libcurl replaces the old host+key into the known_hosts file before continuing with the connection. This also adds the new host+key combo to the known_host pool kept in memory if it was not already present there. The adding of data to the file is done by completely replacing the file with a new copy, so the permissions of the file must allow this.</p>
<p><code>CURLKHSTAT_FINE_ADD_TO_FILE</code> - The host+key is accepted and libcurl appends it to the known_hosts file before continuing with the connection. This also adds the host+key combo to the known_host pool kept in memory if it was not already present there. The adding of data to the file is done by completely replacing the file with a new copy, so the permissions of the file must allow this.</p>
<p><code>CURLKHSTAT_FINE</code> - The host+key is accepted libcurl continues with the connection. This also adds the host+key combo to the known_host pool kept in memory if it was not already present there.</p>
<p><code>CURLKHSTAT_REJECT</code> - The host+key is rejected. libcurl denies the connection to continue and it closes.</p>
<p><code>CURLKHSTAT_DEFER</code> - The host+key is rejected, but the SSH connection is asked to be kept alive. This feature could be used when the app wants to somehow return and act on the host+key situation and then retry without needing the overhead of setting it up from scratch again.</p>
<p><span id="transfers__callbacks__rtsp__md"></span></p>
</section>
</body>
</html>
