- en: TLS options
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: TLS选项
- en: At the time of writing this, there are no less than **forty** different options
    for curl_easy_setopt that are dedicated for controlling how libcurl does SSL and
    TLS.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: 在撰写本文时，curl_easy_setopt至少有**四十**个不同的选项是专门用于控制libcurl如何进行SSL和TLS。
- en: Transfers done using TLS use safe defaults but since curl is used in many different
    scenarios and setups, chances are you end up in situations where you want to change
    those behaviors.
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 使用TLS进行的传输使用安全默认值，但由于curl被用于许多不同的场景和配置中，您可能会遇到想要更改这些行为的情况。
- en: Protocol version
  id: totrans-3
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 协议版本
- en: With `CURLOPT_SSLVERSION' and`CURLOPT_PROXY_SSLVERSION`you can specify which
    SSL or TLS protocol range that is acceptable to you. Traditionally SSL and TLS
    protocol versions have been found detect and unsuitable for use over time and
    even if curl itself raises its default lower version over time you might want
    to opt for only using the latest and most security protocol versions.
  id: totrans-4
  prefs: []
  type: TYPE_NORMAL
  zh: 使用`CURLOPT_SSLVERSION`和`CURLOPT_PROXY_SSLVERSION`，您可以指定您可接受的SSL或TLS协议范围。传统上，SSL和TLS协议版本随着时间的推移被发现检测不合适，即使curl本身随着时间的推移提高了默认的较低版本，您可能只想使用最新和最安全的协议版本。
- en: These options take a lowest acceptable version and optionally a maximum. If
    the server cannot negotiate a connection with that condition, the transfer fails.
  id: totrans-5
  prefs: []
  type: TYPE_NORMAL
  zh: 这些选项接受最低可接受版本和可选的最高版本。如果服务器无法根据这些条件协商连接，传输将失败。
- en: 'Example:'
  id: totrans-6
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE0]'
  id: totrans-7
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: Protocol details and behavior
  id: totrans-8
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 协议细节和行为
- en: You can select what ciphers to use by setting `CURLOPT_SSL_CIPHER_LIST` and
    `CURLOPT_PROXY_SSL_CIPHER_LIST`.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以通过设置`CURLOPT_SSL_CIPHER_LIST`和`CURLOPT_PROXY_SSL_CIPHER_LIST`来选择要使用的加密套件。
- en: You can ask to enable SSL “False Start” with `CURLOPT_SSL_FALSESTART`, and there
    are a few other behavior changes to tweak using `CURLOPT_SSL_OPTIONS`.
  id: totrans-10
  prefs: []
  type: TYPE_NORMAL
  zh: 您可以使用`CURLOPT_SSL_FALSESTART`请求启用SSL“False Start”，并且还有其他一些行为变化可以通过`CURLOPT_SSL_OPTIONS`进行调整。
- en: Verification
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 验证
- en: A TLS-using client needs to verify that the server it speaks to is the correct
    and trusted one. This is done by verifying that the server’s certificate is signed
    by a Certificate Authority (CA) for which curl has a public key for and that the
    certificate contains the server’s name. Failing any of these checks cause the
    transfer to fail.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 使用TLS的客户端需要验证它与服务器通信的是正确且受信任的。这是通过验证服务器的证书是否由curl具有公钥的证书机构（CA）签名，并且证书包含服务器的名称来完成的。任何这些检查失败都会导致传输失败。
- en: For development purposes and for experimenting, curl allows an application to
    switch off either or both of these checks for the server or for an HTTPS proxy.
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 为了开发目的和实验，curl允许应用程序关闭服务器或HTTPS代理的任一或两个检查。
- en: '`CURLOPT_SSL_VERIFYPEER` controls the check that the certificate is signed
    by a trusted CA.'
  id: totrans-14
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CURLOPT_SSL_VERIFYPEER`控制检查证书是否由受信任的CA签名。'
- en: '`CURLOPT_SSL_VERIFYHOST` controls the check for the name within the certificate.'
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CURLOPT_SSL_VERIFYHOST`控制对证书中名称的检查。'
- en: '`CURLOPT_PROXY_SSL_VERIFYPEER` is the proxy version of `CURLOPT_SSL_VERIFYPEER`.'
  id: totrans-16
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CURLOPT_PROXY_SSL_VERIFYPEER`是`CURLOPT_SSL_VERIFYPEER`的代理版本。'
- en: '`CURLOPT_PROXY_SSL_VERIFYHOST` is the proxy version of `CURLOPT_SSL_VERIFYHOST`.'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`CURLOPT_PROXY_SSL_VERIFYHOST`是`CURLOPT_SSL_VERIFYHOST`的代理版本。'
- en: Optionally, you can tell curl to verify the certificate’s public key against
    a known hash using `CURLOPT_PINNEDPUBLICKEY` or `CURLOPT_PROXY_PINNEDPUBLICKEY`.
    Here too, a mismatch causes the transfer to fail.
  id: totrans-18
  prefs: []
  type: TYPE_NORMAL
  zh: 可选地，您可以通过使用`CURLOPT_PINNEDPUBLICKEY`或`CURLOPT_PROXY_PINNEDPUBLICKEY`告诉curl验证证书的公钥与已知散列相匹配。在这里，不匹配也会导致传输失败。
- en: Authentication
  id: totrans-19
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 认证
- en: TLS Client certificates
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: TLS客户端证书
- en: When using TLS and the server asks the client to authenticate using certificates,
    you typically specify the private key and the corresponding client certificate
    using `CURLOPT_SSLKEY` and `CURLOPT_SSLCERT`. The password for the key is usually
    also required to be set, with `CURLOPT_SSLKEYPASSWD`.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 当使用TLS并且服务器要求客户端使用证书进行认证时，您通常使用`CURLOPT_SSLKEY`和`CURLOPT_SSLCERT`指定私钥和相应的客户端证书。通常还需要设置密钥的密码，使用`CURLOPT_SSLKEYPASSWD`。
- en: 'Again, the same set of options exist separately for connections to HTTPS proxies:
    `CURLOPT_PROXY_SSLKEY`, `CURLOPT_PROXY_SSLCERT` etc.'
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 再次强调，对于连接到HTTPS代理的选项，存在一组独立的选项：`CURLOPT_PROXY_SSLKEY`、`CURLOPT_PROXY_SSLCERT`等。
- en: TLS auth
  id: totrans-23
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: TLS认证
- en: TLS connections offer a (rarely used) feature called Secure Remote Passwords.
    Using this, you authenticate the connection for the server using a name and password
    and the options are called `CURLOPT_TLSAUTH_USERNAME` and `CURLOPT_TLSAUTH_PASSWORD`.
  id: totrans-24
  prefs: []
  type: TYPE_NORMAL
  zh: TLS连接提供了一个（很少使用）称为安全远程密码的功能。使用此功能，您可以使用名称和密码对服务器连接进行认证，选项称为`CURLOPT_TLSAUTH_USERNAME`和`CURLOPT_TLSAUTH_PASSWORD`。
- en: STARTTLS
  id: totrans-25
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: STARTTLS
- en: For protocols that are using the STARTTLS method to upgrade the connection to
    TLS (FTP, IMAP, POP3, and SMTP), you usually tell curl to use the non-TLS version
    of the protocol when specifying a URL and then ask curl to enable TLS with the
    `CURLOPT_USE_SSL` option.
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 对于使用STARTTLS方法升级连接到TLS的协议（如FTP、IMAP、POP3和SMTP），你通常在指定URL时告诉curl使用该协议的非TLS版本，然后请求curl使用`CURLOPT_USE_SSL`选项启用TLS。
- en: This option allows a client to let curl continue if it cannot upgrade to TLS,
    but that is not a recommend path to walk as then you might be using an insecure
    protocol without properly noticing.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 此选项允许客户端在无法升级到TLS时让curl继续执行，但这并不是推荐的做法，因为这样你可能会在不经意间使用一个不安全的协议。
- en: '[PRE1]'
  id: totrans-28
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
