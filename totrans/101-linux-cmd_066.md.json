["```sh\n      iptables [options] [chain] [rule-specification] [target] \n\n```", "```sh\n      # List all rules\nsudo iptables -L\n\n# List rules with line numbers\nsudo iptables -L --line-numbers\n\n# List rules in specific table\nsudo iptables -t nat -L\nsudo iptables -t mangle -L\n\n# Show packet and byte counters\nsudo iptables -L -v\n\n# Show rules in iptables-save format\nsudo iptables -S \n\n```", "```sh\n      # Add rule to end of chain\nsudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT\n\n# Insert rule at specific position\nsudo iptables -I INPUT 1 -p tcp --dport 80 -j ACCEPT\n\n# Delete specific rule\nsudo iptables -D INPUT -p tcp --dport 22 -j ACCEPT\n\n# Delete rule by line number\nsudo iptables -D INPUT 3\n\n# Replace rule at specific position\nsudo iptables -R INPUT 1 -p tcp --dport 443 -j ACCEPT \n\n```", "```sh\n      # Allow SSH (port 22)\nsudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT\n\n# Allow HTTP (port 80)\nsudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT\n\n# Allow HTTPS (port 443)\nsudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT\n\n# Block specific port\nsudo iptables -A INPUT -p tcp --dport 8080 -j DROP \n\n```", "```sh\n      # Allow specific IP\nsudo iptables -A INPUT -s 192.168.1.100 -j ACCEPT\n\n# Block specific IP\nsudo iptables -A INPUT -s 192.168.1.50 -j DROP\n\n# Allow subnet\nsudo iptables -A INPUT -s 192.168.1.0/24 -j ACCEPT\n\n# Block IP range\nsudo iptables -A INPUT -m iprange --src-range 192.168.1.100-192.168.1.200 -j DROP \n\n```", "```sh\n      # Allow traffic on loopback\nsudo iptables -A INPUT -i lo -j ACCEPT\n\n# Allow on specific interface\nsudo iptables -A INPUT -i eth0 -p tcp --dport 80 -j ACCEPT\n\n# Block on specific interface\nsudo iptables -A INPUT -i eth1 -j DROP \n\n```", "```sh\n      # Allow established and related connections\nsudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# Allow new connections on specific ports\nsudo iptables -A INPUT -m state --state NEW -p tcp --dport 22 -j ACCEPT \n\n```", "```sh\n      # Limit SSH connections (6 per minute)\nsudo iptables -A INPUT -p tcp --dport 22 -m limit --limit 6/min -j ACCEPT\n\n# Limit ping requests\nsudo iptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit 1/sec -j ACCEPT \n\n```", "```sh\n      # Allow access during business hours\nsudo iptables -A INPUT -p tcp --dport 80 -m time --timestart 09:00 --timestop 17:00 -j ACCEPT\n\n# Allow access on weekdays\nsudo iptables -A INPUT -p tcp --dport 22 -m time --weekdays Mon,Tue,Wed,Thu,Fri -j ACCEPT \n\n```", "```sh\n      # Allow multiple ports\nsudo iptables -A INPUT -p tcp -m multiport --dports 22,80,443 -j ACCEPT\n\n# Block multiple ports\nsudo iptables -A INPUT -p tcp -m multiport --dports 135,445,1433 -j DROP \n\n```", "```sh\n      # Static SNAT\nsudo iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j SNAT --to-source 203.0.113.1\n\n# Dynamic SNAT (Masquerading)\nsudo iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE \n\n```", "```sh\n      # Port forwarding\nsudo iptables -t nat -A PREROUTING -p tcp --dport 8080 -j DNAT --to-destination 192.168.1.100:80\n\n# Forward to different IP\nsudo iptables -t nat -A PREROUTING -d 203.0.113.1 -j DNAT --to-destination 192.168.1.100 \n\n```", "```sh\n      # Set default policies\nsudo iptables -P INPUT DROP\nsudo iptables -P FORWARD DROP\nsudo iptables -P OUTPUT ACCEPT\n\n# View current policies\nsudo iptables -L | grep \"policy\" \n\n```", "```sh\n      # Create custom chain\nsudo iptables -N CUSTOM_CHAIN\n\n# Delete custom chain (must be empty)\nsudo iptables -X CUSTOM_CHAIN\n\n# Flush specific chain\nsudo iptables -F INPUT\n\n# Flush all chains\nsudo iptables -F \n\n```", "```sh\n      # Log dropped packets\nsudo iptables -A INPUT -j LOG --log-prefix \"DROPPED: \" --log-level 4\n\n# Log before dropping\nsudo iptables -A INPUT -p tcp --dport 23 -j LOG --log-prefix \"TELNET_ATTEMPT: \"\nsudo iptables -A INPUT -p tcp --dport 23 -j DROP\n\n# View logs\nsudo tail -f /var/log/syslog | grep \"DROPPED:\" \n\n```", "```sh\n      #!/bin/bash# Clear existing rules\nsudo iptables -F\nsudo iptables -X\nsudo iptables -t nat -F\nsudo iptables -t nat -X\n\n# Default policies\nsudo iptables -P INPUT DROP\nsudo iptables -P FORWARD DROP\nsudo iptables -P OUTPUT ACCEPT\n\n# Allow loopback\nsudo iptables -A INPUT -i lo -j ACCEPT\n\n# Allow established connections\nsudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# Allow SSH\nsudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT\n\n# Allow ping\nsudo iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT \n\n```", "```sh\n      #!/bin/bash# Basic web server configuration\nsudo iptables -F\n\n# Default policies\nsudo iptables -P INPUT DROP\nsudo iptables -P FORWARD DROP\nsudo iptables -P OUTPUT ACCEPT\n\n# Allow loopback and established connections\nsudo iptables -A INPUT -i lo -j ACCEPT\nsudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# Allow SSH (limit attempts)\nsudo iptables -A INPUT -p tcp --dport 22 -m limit --limit 6/min -j ACCEPT\n\n# Allow HTTP/HTTPS\nsudo iptables -A INPUT -p tcp --dport 80 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 443 -j ACCEPT\n\n# Allow ping\nsudo iptables -A INPUT -p icmp --icmp-type echo-request -j ACCEPT \n\n```", "```sh\n      #!/bin/bash# Enable IP forwardingecho 1 > /proc/sys/net/ipv4/ip_forward\n\n# NAT for internal network\nsudo iptables -t nat -A POSTROUTING -s 192.168.1.0/24 -o eth0 -j MASQUERADE\n\n# Allow forwarding for established connections\nsudo iptables -A FORWARD -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# Allow forwarding from internal network\nsudo iptables -A FORWARD -s 192.168.1.0/24 -j ACCEPT \n\n```", "```sh\n      # Save current rules\nsudo iptables-save > /etc/iptables/rules.v4\n\n# Restore rules\nsudo iptables-restore < /etc/iptables/rules.v4\n\n# Install persistence package (Ubuntu/Debian)\nsudo apt install iptables-persistent \n\n```", "```sh\n      # Create systemd service\nsudo vim /etc/systemd/system/iptables-restore.service\n\n[Unit]\nDescription=Restore iptables firewall rules\nBefore=network-pre.target\n\n[Service]\nType=oneshot\nExecStart=/sbin/iptables-restore /etc/iptables/rules.v4\n\n[Install]\nWantedBy=multi-user.target\n\n# Enable service\nsudo systemctl enable iptables-restore.service \n\n```", "```sh\n      # Test connectivity\ntelnet target-ip port\nnc -zv target-ip port\n\n# Check if rule matches\nsudo iptables -L -v -n | grep \"rule-description\"\n\n# Monitor rule usage\nwatch \"sudo iptables -L -v -n\" \n\n```", "```sh\n      # Enable all logging temporarily\nsudo iptables -A INPUT -j LOG --log-prefix \"INPUT: \"\nsudo iptables -A OUTPUT -j LOG --log-prefix \"OUTPUT: \"\nsudo iptables -A FORWARD -j LOG --log-prefix \"FORWARD: \"\n\n# Monitor logs\nsudo tail -f /var/log/syslog | grep \"INPUT:\\|OUTPUT:\\|FORWARD:\" \n\n```", "```sh\n      # Temporary rule to allow all (emergency)\nsudo iptables -I INPUT 1 -j ACCEPT\n\n# Flush all rules (removes all protection)\nsudo iptables -F\nsudo iptables -X\nsudo iptables -P INPUT ACCEPT\nsudo iptables -P OUTPUT ACCEPT\nsudo iptables -P FORWARD ACCEPT \n\n```", "```sh\n      # Always start with deny-all policy\nsudo iptables -P INPUT DROP\nsudo iptables -P FORWARD DROP\n# Keep OUTPUT as ACCEPT for normal operation \n\n```", "```sh\n      # More specific rules should come first\nsudo iptables -I INPUT 1 -s 192.168.1.100 -p tcp --dport 22 -j ACCEPT\nsudo iptables -A INPUT -p tcp --dport 22 -j DROP \n\n```", "```sh\n      # Protect SSH from brute force\nsudo iptables -A INPUT -p tcp --dport 22 -m recent --set --name SSH\nsudo iptables -A INPUT -p tcp --dport 22 -m recent --update --seconds 60 --hitcount 3 --name SSH -j DROP\nsudo iptables -A INPUT -p tcp --dport 22 -j ACCEPT \n\n```", "```sh\n      # Use connection tracking for better performance\nsudo iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# Place frequently matched rules first\nsudo iptables -I INPUT 1 -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n# Use specific matches to reduce processing\nsudo iptables -A INPUT -p tcp --dport 80 -s 192.168.1.0/24 -j ACCEPT \n\n```"]