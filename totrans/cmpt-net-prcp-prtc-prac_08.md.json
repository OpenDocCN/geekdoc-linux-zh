["```sh\n#mtu : maximum size of the packet (including header) of outgoing link\nif p.len <  mtu :\n send(p)\n# packet is too large\nmaxpayload=8*int((mtu-20)/8)  # must be n times 8 bytes\nif p.flags=='DF' :\n discard(p)\n# packet must be fragmented\npayload=p[IP].payload\npos=0\nwhile len(payload) > 0 :\n if len(payload) > maxpayload :\n    toSend=IP(dest=p.dest,src=p.src,\n              ttl=p.ttl, id=p.id,\n              frag=p.frag+(pos/8),\n              len=mtu, proto=p.proto)/payload[0:maxpayload]\n    pos=pos+maxpayload\n    payload=payload[maxpayload+1:]\n else\n    toSend=IP(dest=p.dest,src=p.src,\n              ttl=p.ttl, id=p.id,\n              frag=p.frag+(pos/8),\n              flags=p.flags,\n              len=len(payload), proto=p.proto)/payload\n forward(toSend) \n```", "```sh\nping 130.104.1.1\nPING 130.104.1.1 (130.104.1.1): 56 data bytes\n64 bytes from 130.104.1.1: icmp_seq=0 ttl=243 time=19.961 ms\n64 bytes from 130.104.1.1: icmp_seq=1 ttl=243 time=22.072 ms\n64 bytes from 130.104.1.1: icmp_seq=2 ttl=243 time=23.064 ms\n64 bytes from 130.104.1.1: icmp_seq=3 ttl=243 time=20.026 ms\n64 bytes from 130.104.1.1: icmp_seq=4 ttl=243 time=25.099 ms\n--- 130.104.1.1 ping statistics ---\n5 packets transmitted, 5 packets received, 0% packet loss\nround-trip min/avg/max/stddev = 19.961/22.044/25.099/1.938 ms \n```", "```sh\ntraceroute www.ietf.org\ntraceroute to www.ietf.org (64.170.98.32), 64 hops max, 40 byte packets\n 1  CsHalles3.sri.ucl.ac.be (192.168.251.230)  5.376 ms  1.217 ms  1.137 ms\n 2  CtHalles.sri.ucl.ac.be (192.168.251.229)  1.444 ms  1.669 ms  1.301 ms\n 3  CtPythagore.sri.ucl.ac.be (130.104.254.230)  1.950 ms  4.688 ms  1.319 ms\n 4  fe.m20.access.lln.belnet.net (193.191.11.9)  1.578 ms  1.272 ms  1.259 ms\n 5  10ge.cr2.brueve.belnet.net (193.191.16.22)  5.461 ms  4.241 ms  4.162 ms\n 6  212.3.237.13 (212.3.237.13)  5.347 ms  4.544 ms  4.285 ms\n 7  ae-11-11.car1.Brussels1.Level3.net (4.69.136.249)  5.195 ms  4.304 ms  4.329 ms\n 8  ae-6-6.ebr1.London1.Level3.net (4.69.136.246)  8.892 ms  8.980 ms  8.830 ms\n 9  ae-100-100.ebr2.London1.Level3.net (4.69.141.166)  8.925 ms  8.950 ms  9.006 ms\n 10  ae-41-41.ebr1.NewYork1.Level3.net (4.69.137.66)  79.590 ms\n     ae-43-43.ebr1.NewYork1.Level3.net (4.69.137.74)  78.140 ms\n     ae-42-42.ebr1.NewYork1.Level3.net (4.69.137.70)  77.663 ms\n 11  ae-2-2.ebr1.Newark1.Level3.net (4.69.132.98)  78.290 ms  83.765 ms  90.006 ms\n 12  ae-14-51.car4.Newark1.Level3.net (4.68.99.8)  78.309 ms  78.257 ms  79.709 ms\n 13  ex1-tg2-0.eqnwnj.sbcglobal.net (151.164.89.249)  78.460 ms  78.452 ms  78.292 ms\n 14  151.164.95.190 (151.164.95.190)  157.198 ms  160.767 ms  159.898 ms\n 15  ded-p10-0.pltn13.sbcglobal.net (151.164.191.243)  161.872 ms  156.996 ms  159.425 ms\n 16  AMS-1152322.cust-rtr.swbell.net (75.61.192.10)  158.735 ms  158.485 ms  158.588 ms\n 17  mail.ietf.org (64.170.98.32)  158.427 ms  158.502 ms  158.567 ms \n```", "```sh\n# mtu : maximum size of the packet (including header) of outgoing link\n# In Scapy-like notation (see https://github.com/secdev/scapy)\nif p.len < mtu:\n    send(p)\nelse:\n    # packet is too large\n    # 40 refers to the size of the IPv6 header\n    maxpayload = 8 * int((mtu - 40) / 8)  # must be n times 8 bytes\n    # packet must be fragmented\n    payload = p[IPv6].payload\n    pos = 0\n    id = globalCounter\n    globalCounter += 1\n    while len(payload) > 0:\n        if len(payload) > maxpayload:\n            toSend = IPv6(dst=p.dst, src=p.src, plen=mtu,\n                          hlim=p.hlim, nh=44)/IPv6ExtHdrFrament(\n                              id=id, offset=p.offset + (pos/8), m=True,\n                              nh=p.nh)/payload[0:maxpayload]\n            pos = pos + maxpayload\n            payload = payload[maxpayload+1:]\n        else:\n            # The last fragment\n            toSend = IPv6(dst=p.dst, src=p.src, plen=len(payload),\n                          hlim=p.hlim, nh=44)/IPv6ExtHdrFrament(\n                              id=id, offset=p.offset + (pos/8), m=False,\n                              nh=p.nh)/payload\n            payload = []\n\n        forward(toSend) \n```", "```sh\n#ping6  www.ietf.org\nPING6(56=40+8+8 bytes) 2001:6a8:3080:2:3403:bbf4:edae:afc3 --> 2001:1890:123a::1:1e\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=0 hlim=49 time=156.905 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=1 hlim=49 time=155.618 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=2 hlim=49 time=155.808 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=3 hlim=49 time=155.325 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=4 hlim=49 time=155.493 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=5 hlim=49 time=155.801 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=6 hlim=49 time=155.660 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=7 hlim=49 time=155.869 ms\n^C\n--- www.ietf.org ping6 statistics ---\n8 packets transmitted, 8 packets received, 0.0% packet loss\nround-trip min/avg/max/std-dev = 155.325/155.810/156.905/0.447 ms \n```", "```sh\n#traceroute6  www.ietf.org\ntraceroute6 to www.ietf.org (2001:1890:1112:1::20) from 2001:6a8:3080:2:217:f2ff:fed6:65c0, 30 hops max, 12 byte packets\n 1  2001:6a8:3080:2::1  13.821 ms  0.301 ms  0.324 ms\n 2  2001:6a8:3000:8000::1  0.651 ms  0.51 ms  0.495 ms\n 3  10ge.cr2.bruvil.belnet.net  3.402 ms  3.34 ms  3.33 ms\n 4  10ge.cr2.brueve.belnet.net  3.668 ms 10ge.cr2.brueve.belnet.net  3.988 ms 10ge.cr2.brueve.belnet.net  3.699 ms\n 5  belnet.rt1.ams.nl.geant2.net  10.598 ms  7.214 ms  10.082 ms\n 6  so-7-0-0.rt2.cop.dk.geant2.net  20.19 ms  20.002 ms  20.064 ms\n 7  kbn-ipv6-b1.ipv6.telia.net  21.078 ms  20.868 ms  20.864 ms\n 8  s-ipv6-b1-link.ipv6.telia.net  31.312 ms  31.113 ms  31.411 ms\n 9  s-ipv6-b1-link.ipv6.telia.net  61.986 ms  61.988 ms  61.994 ms\n 10  2001:1890:61:8909::1  121.716 ms  121.779 ms  121.177 ms\n 11  2001:1890:61:9117::2  203.709 ms  203.305 ms  203.07 ms\n 12  mail.ietf.org  204.172 ms  203.755 ms  203.748 ms \n```", "```sh\n#mtu : maximum size of the packet (including header) of outgoing link\nif p.len <  mtu :\n send(p)\n# packet is too large\nmaxpayload=8*int((mtu-20)/8)  # must be n times 8 bytes\nif p.flags=='DF' :\n discard(p)\n# packet must be fragmented\npayload=p[IP].payload\npos=0\nwhile len(payload) > 0 :\n if len(payload) > maxpayload :\n    toSend=IP(dest=p.dest,src=p.src,\n              ttl=p.ttl, id=p.id,\n              frag=p.frag+(pos/8),\n              len=mtu, proto=p.proto)/payload[0:maxpayload]\n    pos=pos+maxpayload\n    payload=payload[maxpayload+1:]\n else\n    toSend=IP(dest=p.dest,src=p.src,\n              ttl=p.ttl, id=p.id,\n              frag=p.frag+(pos/8),\n              flags=p.flags,\n              len=len(payload), proto=p.proto)/payload\n forward(toSend) \n```", "```sh\n#mtu : maximum size of the packet (including header) of outgoing link\nif p.len <  mtu :\n send(p)\n# packet is too large\nmaxpayload=8*int((mtu-20)/8)  # must be n times 8 bytes\nif p.flags=='DF' :\n discard(p)\n# packet must be fragmented\npayload=p[IP].payload\npos=0\nwhile len(payload) > 0 :\n if len(payload) > maxpayload :\n    toSend=IP(dest=p.dest,src=p.src,\n              ttl=p.ttl, id=p.id,\n              frag=p.frag+(pos/8),\n              len=mtu, proto=p.proto)/payload[0:maxpayload]\n    pos=pos+maxpayload\n    payload=payload[maxpayload+1:]\n else\n    toSend=IP(dest=p.dest,src=p.src,\n              ttl=p.ttl, id=p.id,\n              frag=p.frag+(pos/8),\n              flags=p.flags,\n              len=len(payload), proto=p.proto)/payload\n forward(toSend) \n```", "```sh\nping 130.104.1.1\nPING 130.104.1.1 (130.104.1.1): 56 data bytes\n64 bytes from 130.104.1.1: icmp_seq=0 ttl=243 time=19.961 ms\n64 bytes from 130.104.1.1: icmp_seq=1 ttl=243 time=22.072 ms\n64 bytes from 130.104.1.1: icmp_seq=2 ttl=243 time=23.064 ms\n64 bytes from 130.104.1.1: icmp_seq=3 ttl=243 time=20.026 ms\n64 bytes from 130.104.1.1: icmp_seq=4 ttl=243 time=25.099 ms\n--- 130.104.1.1 ping statistics ---\n5 packets transmitted, 5 packets received, 0% packet loss\nround-trip min/avg/max/stddev = 19.961/22.044/25.099/1.938 ms \n```", "```sh\ntraceroute www.ietf.org\ntraceroute to www.ietf.org (64.170.98.32), 64 hops max, 40 byte packets\n 1  CsHalles3.sri.ucl.ac.be (192.168.251.230)  5.376 ms  1.217 ms  1.137 ms\n 2  CtHalles.sri.ucl.ac.be (192.168.251.229)  1.444 ms  1.669 ms  1.301 ms\n 3  CtPythagore.sri.ucl.ac.be (130.104.254.230)  1.950 ms  4.688 ms  1.319 ms\n 4  fe.m20.access.lln.belnet.net (193.191.11.9)  1.578 ms  1.272 ms  1.259 ms\n 5  10ge.cr2.brueve.belnet.net (193.191.16.22)  5.461 ms  4.241 ms  4.162 ms\n 6  212.3.237.13 (212.3.237.13)  5.347 ms  4.544 ms  4.285 ms\n 7  ae-11-11.car1.Brussels1.Level3.net (4.69.136.249)  5.195 ms  4.304 ms  4.329 ms\n 8  ae-6-6.ebr1.London1.Level3.net (4.69.136.246)  8.892 ms  8.980 ms  8.830 ms\n 9  ae-100-100.ebr2.London1.Level3.net (4.69.141.166)  8.925 ms  8.950 ms  9.006 ms\n 10  ae-41-41.ebr1.NewYork1.Level3.net (4.69.137.66)  79.590 ms\n     ae-43-43.ebr1.NewYork1.Level3.net (4.69.137.74)  78.140 ms\n     ae-42-42.ebr1.NewYork1.Level3.net (4.69.137.70)  77.663 ms\n 11  ae-2-2.ebr1.Newark1.Level3.net (4.69.132.98)  78.290 ms  83.765 ms  90.006 ms\n 12  ae-14-51.car4.Newark1.Level3.net (4.68.99.8)  78.309 ms  78.257 ms  79.709 ms\n 13  ex1-tg2-0.eqnwnj.sbcglobal.net (151.164.89.249)  78.460 ms  78.452 ms  78.292 ms\n 14  151.164.95.190 (151.164.95.190)  157.198 ms  160.767 ms  159.898 ms\n 15  ded-p10-0.pltn13.sbcglobal.net (151.164.191.243)  161.872 ms  156.996 ms  159.425 ms\n 16  AMS-1152322.cust-rtr.swbell.net (75.61.192.10)  158.735 ms  158.485 ms  158.588 ms\n 17  mail.ietf.org (64.170.98.32)  158.427 ms  158.502 ms  158.567 ms \n```", "```sh\n# mtu : maximum size of the packet (including header) of outgoing link\n# In Scapy-like notation (see https://github.com/secdev/scapy)\nif p.len < mtu:\n    send(p)\nelse:\n    # packet is too large\n    # 40 refers to the size of the IPv6 header\n    maxpayload = 8 * int((mtu - 40) / 8)  # must be n times 8 bytes\n    # packet must be fragmented\n    payload = p[IPv6].payload\n    pos = 0\n    id = globalCounter\n    globalCounter += 1\n    while len(payload) > 0:\n        if len(payload) > maxpayload:\n            toSend = IPv6(dst=p.dst, src=p.src, plen=mtu,\n                          hlim=p.hlim, nh=44)/IPv6ExtHdrFrament(\n                              id=id, offset=p.offset + (pos/8), m=True,\n                              nh=p.nh)/payload[0:maxpayload]\n            pos = pos + maxpayload\n            payload = payload[maxpayload+1:]\n        else:\n            # The last fragment\n            toSend = IPv6(dst=p.dst, src=p.src, plen=len(payload),\n                          hlim=p.hlim, nh=44)/IPv6ExtHdrFrament(\n                              id=id, offset=p.offset + (pos/8), m=False,\n                              nh=p.nh)/payload\n            payload = []\n\n        forward(toSend) \n```", "```sh\n#ping6  www.ietf.org\nPING6(56=40+8+8 bytes) 2001:6a8:3080:2:3403:bbf4:edae:afc3 --> 2001:1890:123a::1:1e\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=0 hlim=49 time=156.905 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=1 hlim=49 time=155.618 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=2 hlim=49 time=155.808 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=3 hlim=49 time=155.325 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=4 hlim=49 time=155.493 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=5 hlim=49 time=155.801 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=6 hlim=49 time=155.660 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=7 hlim=49 time=155.869 ms\n^C\n--- www.ietf.org ping6 statistics ---\n8 packets transmitted, 8 packets received, 0.0% packet loss\nround-trip min/avg/max/std-dev = 155.325/155.810/156.905/0.447 ms \n```", "```sh\n#traceroute6  www.ietf.org\ntraceroute6 to www.ietf.org (2001:1890:1112:1::20) from 2001:6a8:3080:2:217:f2ff:fed6:65c0, 30 hops max, 12 byte packets\n 1  2001:6a8:3080:2::1  13.821 ms  0.301 ms  0.324 ms\n 2  2001:6a8:3000:8000::1  0.651 ms  0.51 ms  0.495 ms\n 3  10ge.cr2.bruvil.belnet.net  3.402 ms  3.34 ms  3.33 ms\n 4  10ge.cr2.brueve.belnet.net  3.668 ms 10ge.cr2.brueve.belnet.net  3.988 ms 10ge.cr2.brueve.belnet.net  3.699 ms\n 5  belnet.rt1.ams.nl.geant2.net  10.598 ms  7.214 ms  10.082 ms\n 6  so-7-0-0.rt2.cop.dk.geant2.net  20.19 ms  20.002 ms  20.064 ms\n 7  kbn-ipv6-b1.ipv6.telia.net  21.078 ms  20.868 ms  20.864 ms\n 8  s-ipv6-b1-link.ipv6.telia.net  31.312 ms  31.113 ms  31.411 ms\n 9  s-ipv6-b1-link.ipv6.telia.net  61.986 ms  61.988 ms  61.994 ms\n 10  2001:1890:61:8909::1  121.716 ms  121.779 ms  121.177 ms\n 11  2001:1890:61:9117::2  203.709 ms  203.305 ms  203.07 ms\n 12  mail.ietf.org  204.172 ms  203.755 ms  203.748 ms \n```", "```sh\n# mtu : maximum size of the packet (including header) of outgoing link\n# In Scapy-like notation (see https://github.com/secdev/scapy)\nif p.len < mtu:\n    send(p)\nelse:\n    # packet is too large\n    # 40 refers to the size of the IPv6 header\n    maxpayload = 8 * int((mtu - 40) / 8)  # must be n times 8 bytes\n    # packet must be fragmented\n    payload = p[IPv6].payload\n    pos = 0\n    id = globalCounter\n    globalCounter += 1\n    while len(payload) > 0:\n        if len(payload) > maxpayload:\n            toSend = IPv6(dst=p.dst, src=p.src, plen=mtu,\n                          hlim=p.hlim, nh=44)/IPv6ExtHdrFrament(\n                              id=id, offset=p.offset + (pos/8), m=True,\n                              nh=p.nh)/payload[0:maxpayload]\n            pos = pos + maxpayload\n            payload = payload[maxpayload+1:]\n        else:\n            # The last fragment\n            toSend = IPv6(dst=p.dst, src=p.src, plen=len(payload),\n                          hlim=p.hlim, nh=44)/IPv6ExtHdrFrament(\n                              id=id, offset=p.offset + (pos/8), m=False,\n                              nh=p.nh)/payload\n            payload = []\n\n        forward(toSend) \n```", "```sh\n#ping6  www.ietf.org\nPING6(56=40+8+8 bytes) 2001:6a8:3080:2:3403:bbf4:edae:afc3 --> 2001:1890:123a::1:1e\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=0 hlim=49 time=156.905 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=1 hlim=49 time=155.618 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=2 hlim=49 time=155.808 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=3 hlim=49 time=155.325 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=4 hlim=49 time=155.493 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=5 hlim=49 time=155.801 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=6 hlim=49 time=155.660 ms\n16 bytes from 2001:1890:123a::1:1e, icmp_seq=7 hlim=49 time=155.869 ms\n^C\n--- www.ietf.org ping6 statistics ---\n8 packets transmitted, 8 packets received, 0.0% packet loss\nround-trip min/avg/max/std-dev = 155.325/155.810/156.905/0.447 ms \n```", "```sh\n#traceroute6  www.ietf.org\ntraceroute6 to www.ietf.org (2001:1890:1112:1::20) from 2001:6a8:3080:2:217:f2ff:fed6:65c0, 30 hops max, 12 byte packets\n 1  2001:6a8:3080:2::1  13.821 ms  0.301 ms  0.324 ms\n 2  2001:6a8:3000:8000::1  0.651 ms  0.51 ms  0.495 ms\n 3  10ge.cr2.bruvil.belnet.net  3.402 ms  3.34 ms  3.33 ms\n 4  10ge.cr2.brueve.belnet.net  3.668 ms 10ge.cr2.brueve.belnet.net  3.988 ms 10ge.cr2.brueve.belnet.net  3.699 ms\n 5  belnet.rt1.ams.nl.geant2.net  10.598 ms  7.214 ms  10.082 ms\n 6  so-7-0-0.rt2.cop.dk.geant2.net  20.19 ms  20.002 ms  20.064 ms\n 7  kbn-ipv6-b1.ipv6.telia.net  21.078 ms  20.868 ms  20.864 ms\n 8  s-ipv6-b1-link.ipv6.telia.net  31.312 ms  31.113 ms  31.411 ms\n 9  s-ipv6-b1-link.ipv6.telia.net  61.986 ms  61.988 ms  61.994 ms\n 10  2001:1890:61:8909::1  121.716 ms  121.779 ms  121.177 ms\n 11  2001:1890:61:9117::2  203.709 ms  203.305 ms  203.07 ms\n 12  mail.ietf.org  204.172 ms  203.755 ms  203.748 ms \n```"]