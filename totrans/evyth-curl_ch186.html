<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <title>ch186.xhtml</title>
  <link rel="stylesheet" type="text/css" href="../styles/stylesheet1.css" />
</head>
<body epub:type="bodymatter">
<section id="ftp__cmds__md-_-_-custom-ftp-commands" class="level1" data-number="185">
<h1 data-number="185">Custom FTP commands</h1>
<p>The FTP protocol offers a wide variety of different commands that allow the client to perform actions, other than the plain file transfers that curl is focused on.</p>
<p>A curl user can pass on such extra (custom) commands to the server as a step in the file transfer sequence. curl even offers to have those commands run at different points in the process.</p>
<section id="ftp__cmds__md-_-_-quote" class="level2" data-number="185.1">
<h2 data-number="185.1">Quote</h2>
<p>In the old days the standard old ftp client had a command called <em>quote</em>. It was used to send commands verbatim to the server. curl uses the same name for virtually the same functionality: send the specified command verbatim to the server. Actually one or more commands. <code>-Q</code> or <code>--quote</code>.</p>
<p>To know what commands that are available and possible to send to a server, you need to know a little about the FTP protocol, and possibly read up a bit on RFC 959 on the details.</p>
<p>To send a simple <code>NOOP</code> to the server (which does nothing) <strong>before</strong> the transfer starts, provide it to curl like this:</p>
<pre><code>curl -Q NOOP ftp://example.com/file</code></pre>
<p>To instead send the same command immediately <strong>after</strong> the transfer, prefix the FTP command with a dash:</p>
<pre><code>curl -Q -NOOP ftp://example.com/file</code></pre>
<p>curl also offers to send commands after it changes the working directory, just <strong>before the commands</strong> that kick off the transfer are sent. To send command then, prefix the command with a ‘+’ (plus).</p>
</section>
<section id="ftp__cmds__md-_-_-a-series-of-commands" class="level2" data-number="185.2">
<h2 data-number="185.2">A series of commands</h2>
<p>You can in fact send commands in all three different times by using multiple <code>-Q</code> on the command line. You can also send multiple commands in the same position by using more <code>-Q</code> options.</p>
<p>By default, if any of the given commands returns an error from the server, curl stops its operations, abort the transfer (if it happens before transfer has started) and not send any more of the custom commands.</p>
<p>Example, rename a file then do a transfer:</p>
<pre><code>curl -Q &quot;RNFR original&quot; -Q &quot;RNTO newname&quot; ftp://example.com/newname</code></pre>
</section>
<section id="ftp__cmds__md-_-_-fallible-commands" class="level2" data-number="185.3">
<h2 data-number="185.3">Fallible commands</h2>
<p>You can opt to send individual quote commands that are allowed to fail, to get an error returned from the server without causing everything to stop.</p>
<p>You make the command fallible by prefixing it with an asterisk (<code>*</code>). For example, send a delete (<code>DELE</code>) after a transfer and allow it to fail:</p>
<pre><code>curl -Q &quot;-*DELE file&quot; ftp://example.com/moo</code></pre>
<p><span id="ftp__twoconnections__md"></span></p>
</section>
</section>
</body>
</html>
