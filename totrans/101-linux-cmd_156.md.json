["```sh\n      dmesg [options] \n\n```", "```sh\n      # Display all kernel messages\ndmesg\n\n# Display with human-readable timestamps\ndmesg -T\n\n# Display last 20 lines\ndmesg | tail -20\n\n# Display first 20 lines (boot messages)\ndmesg | head -20 \n\n```", "```sh\n      # Follow new kernel messages (like tail -f)\ndmesg -w\n\n# Follow with timestamps\ndmesg -T -w\n\n# Follow last 10 lines and continue\ndmesg | tail -10 && dmesg -w \n\n```", "```sh\n      # Emergency messages (level 0)\ndmesg -l emerg\n\n# Alert messages (level 1)\ndmesg -l alert\n\n# Critical messages (level 2)\ndmesg -l crit\n\n# Error messages (level 3)\ndmesg -l err\n\n# Warning messages (level 4)\ndmesg -l warn\n\n# Notice messages (level 5)\ndmesg -l notice\n\n# Info messages (level 6)\ndmesg -l info\n\n# Debug messages (level 7)\ndmesg -l debug \n\n```", "```sh\n      # Show errors and warnings\ndmesg -l err,warn\n\n# Show critical and above (crit, alert, emerg)\ndmesg -l crit+\n\n# Show warnings and below (warn, notice, info, debug)\ndmesg -l warn- \n\n```", "```sh\n      # Kernel messages\ndmesg -f kern\n\n# User-space messages\ndmesg -f user\n\n# Mail system messages\ndmesg -f mail\n\n# System daemons\ndmesg -f daemon\n\n# Authorization messages\ndmesg -f auth\n\n# Syslog messages\ndmesg -f syslog \n\n```", "```sh\n      # -T: Human-readable timestamps\ndmesg -T\n\n# -t: Don't show timestamps\ndmesg -t\n\n# -x: Decode facility and level to human-readable\ndmesg -x\n\n# -H: Enable human-readable output\ndmesg -H\n\n# -k: Show kernel messages only\ndmesg -k \n\n```", "```sh\n      # -c: Clear ring buffer after reading\nsudo dmesg -c\n\n# -C: Clear ring buffer\nsudo dmesg -C\n\n# -s: Buffer size\ndmesg -s 65536\n\n# -n: Set console log level\nsudo dmesg -n 1 \n\n```", "```sh\n      # Check USB device detection\ndmesg | grep -i usb\n\n# Check network interface detection\ndmesg | grep -i eth\n\n# Check disk detection\ndmesg | grep -i -E \"(sda|sdb|sdc|nvme)\"\n\n# Check memory detection\ndmesg | grep -i memory\n\n# Check CPU detection\ndmesg | grep -i cpu \n\n```", "```sh\n      # Check loaded drivers\ndmesg | grep -i driver\n\n# Check specific driver (e.g., nvidia)\ndmesg | grep -i nvidia\n\n# Check wireless driver\ndmesg | grep -i wifi\n\n# Check bluetooth driver\ndmesg | grep -i bluetooth\n\n# Check sound driver\ndmesg | grep -i audio \n\n```", "```sh\n      # Show only error messages\ndmesg -l err\n\n# Show errors and warnings\ndmesg -l err,warn\n\n# Search for specific errors\ndmesg | grep -i error\n\n# Search for failed operations\ndmesg | grep -i fail\n\n# Search for timeout issues\ndmesg | grep -i timeout \n\n```", "```sh\n      # Show boot messages with timestamps\ndmesg -T | head -50\n\n# Find boot completion time\ndmesg | grep -i \"boot\"\n\n# Check service startup\ndmesg | grep -i systemd\n\n# Check filesystem mounting\ndmesg | grep -i mount\n\n# Check network initialization\ndmesg | grep -i network \n\n```", "```sh\n      # Messages from last 10 minutes\ndmesg --since=\"10 minutes ago\"\n\n# Messages from last hour\ndmesg --since=\"1 hour ago\"\n\n# Messages from today\ndmesg --since=\"today\"\n\n# Messages from specific time\ndmesg --since=\"2023-01-01 00:00:00\" \n\n```", "```sh\n      # Messages between specific times\ndmesg --since=\"2023-01-01\" --until=\"2023-01-02\"\n\n# Messages from last boot\ndmesg --since=\"last boot\"\n\n# Messages from specific duration\ndmesg --since=\"30 minutes ago\" --until=\"10 minutes ago\" \n\n```", "```sh\n      # Errors from last hour\ndmesg -l err --since=\"1 hour ago\"\n\n# Kernel warnings with timestamps\ndmesg -T -l warn -f kern\n\n# USB-related errors\ndmesg -l err | grep -i usb\n\n# Network errors from today\ndmesg --since=\"today\" | grep -i -E \"(network|eth|wifi)\" \n\n```", "```sh\n      # JSON format\ndmesg --json\n\n# Raw format (no timestamp processing)\ndmesg -r\n\n# Colored output (if supported)\ndmesg --color=always\n\n# No pager\ndmesg --nopager \n\n```", "```sh\n      # Extract specific informationextract_usb_devices() {\n    dmesg | grep -E \"usb.*: New USB device\" | \\\n    sed -n 's/.*New USB device found, idVendor=\\([^,]*\\), idProduct=\\([^ ]*\\).*/Vendor: \\1, Product: \\2/p'\n}\n\nextract_usb_devices \n\n```", "```sh\n      # Monitor for specific eventsmonitor_errors() {\n    dmesg -w -l err | whileÂ read line; do\n        echoÂ \"$(date): $line\"\n        # Send alert\n        echoÂ \"$line\" | mail -s \"Kernel Error Alert\" admin@domain.com\n    done\n}\n\n# Monitor USB connections\nmonitor_usb() {\n    dmesg -w | grep --line-buffered -i usb | whileÂ read line; do\n        echoÂ \"USB Event: $line\"\n    done\n} \n\n```", "```sh\n      #!/bin/bash# Analyze kernel messages for issuesanalyze_dmesg() {\n    echoÂ \"=== Kernel Message Analysis ===\"\n    echoÂ \"Generated: $(date)\"\n    echo\n\n    echoÂ \"Error Messages:\"\n    dmesg -l err | tail -10\n    echo\n\n    echoÂ \"Warning Messages:\"\n    dmesg -l warn | tail -10\n    echo\n\n    echoÂ \"Recent Hardware Events:\"\n    dmesg --since=\"1 hour ago\" | grep -i -E \"(usb|disk|network|memory)\" | tail -10\n    echo\n\n    echoÂ \"Driver Loading Issues:\"\n    dmesg | grep -i -E \"(failed|error|timeout)\" | grep -i driver | tail -5\n}\n\nanalyze_dmesg > kernel_analysis.txt \n\n```", "```sh\n      #!/bin/bash# Check system health using dmesgcheck_system_health() {\n    local issues=0\n\n    echoÂ \"=== System Health Check ===\"\n\n    # Check for critical errors\n    critical_errors=$(dmesg -l crit,alert,emerg --since=\"24 hours ago\" | wc -l)\n    if [ $critical_errors -gt 0 ]; then\n        echoÂ \"âš ï¸  $critical_errors critical errors found in last 24 hours\"\n        ((issues++))\n    else\n        echoÂ \"âœ… No critical errors in last 24 hours\"\n    fi\n\n    # Check for hardware errors\n    hw_errors=$(dmesg --since=\"24 hours ago\" | grep -i -c -E \"(hardware error|machine check|MCE)\")\n    if [ $hw_errors -gt 0 ]; then\n        echoÂ \"âš ï¸  $hw_errors hardware errors detected\"\n        ((issues++))\n    else\n        echoÂ \"âœ… No hardware errors detected\"\n    fi\n\n    # Check for out of memory\n    oom_events=$(dmesg --since=\"24 hours ago\" | grep -i -c \"out of memory\")\n    if [ $oom_events -gt 0 ]; then\n        echoÂ \"âš ï¸  $oom_events out of memory events\"\n        ((issues++))\n    else\n        echoÂ \"âœ… No out of memory events\"\n    fi\n\n    # Check for filesystem errors\n    fs_errors=$(dmesg --since=\"24 hours ago\" | grep -i -c -E \"(filesystem error|ext[234] error|xfs error)\")\n    if [ $fs_errors -gt 0 ]; then\n        echoÂ \"âš ï¸  $fs_errors filesystem errors\"\n        ((issues++))\n    else\n        echoÂ \"âœ… No filesystem errors\"\n    fi\n\n    echo\n    if [ $issues -eq 0 ]; then\n        echoÂ \"ðŸŽ‰ System appears healthy!\"\n    else\n        echoÂ \"âš ï¸  Found $issues types of issues - check details above\"\n    fi\n}\n\ncheck_system_health \n\n```", "```sh\n      # Monitor USB device connectionsmonitor_usb_debug() {\n    echoÂ \"Monitoring USB events (Ctrl+C to stop)...\"\n    dmesg -w | grep --line-buffered -i usb | whileÂ read line; do\n        timestamp=$(date '+%Y-%m-%d %H:%M:%S')\n        echoÂ \"[$timestamp] $line\"\n    done\n}\n\n# Check USB device history\nusb_device_history() {\n    echoÂ \"USB Device Connection History:\"\n    dmesg | grep -i \"usb.*: New USB device\" | tail -10\n    echo\n    echoÂ \"USB Device Disconnections:\"\n    dmesg | grep -i \"usb.*disconnect\" | tail -10\n} \n\n```", "```sh\n      # Check network interface eventscheck_network_issues() {\n    echoÂ \"Network Interface Events:\"\n    dmesg | grep -i -E \"(eth[0-9]|wlan[0-9]|enp|wlp)\" | tail -10\n    echo\n\n    echoÂ \"Network Driver Issues:\"\n    dmesg | grep -i -E \"network.*error|ethernet.*error\" | tail -5\n    echo\n\n    echoÂ \"Link Status Changes:\"\n    dmesg | grep -i \"link\" | tail -10\n} \n\n```", "```sh\n      # Check disk health and errorscheck_storage_health() {\n    echoÂ \"Storage Device Detection:\"\n    dmesg | grep -i -E \"(sda|sdb|nvme)\" | grep -i \"sectors\" | tail -5\n    echo\n\n    echoÂ \"Storage Errors:\"\n    dmesg | grep -i -E \"(I/O error|Medium Error|critical medium error)\" | tail -5\n    echo\n\n    echoÂ \"Filesystem Events:\"\n    dmesg | grep -i -E \"(mounted|unmounted|remounted)\" | tail -10\n} \n\n```", "```sh\n      # Compare kernel messagesechoÂ \"=== dmesg output ===\"\ndmesg --since=\"1 hour ago\" | head -5\n\nechoÂ \"=== journalctl kernel messages ===\"\njournalctl -k --since=\"1 hour ago\" | head -5 \n\n```", "```sh\n      # Save dmesg to file with rotationsave_dmesg_log() {\n    local logfile=\"/var/log/dmesg.log\"\n    local timestamp=$(date '+%Y-%m-%d %H:%M:%S')\n\n    echoÂ \"[$timestamp] === dmesg snapshot ===\" >> \"$logfile\"\n    dmesg -T >> \"$logfile\"\n\n    # Rotate if file gets too large\n    if [ $(stat -f%z \"$logfile\" 2>/dev/null || stat -c%s \"$logfile\") -gt 10485760 ]; then\n        mv \"$logfile\"Â \"$logfile.old\"\n        echoÂ \"Log rotated at $timestamp\" > \"$logfile\"\n    fi\n} \n\n```", "```sh\n      # Create metrics for monitoring systemscreate_dmesg_metrics() {\n    local errors=$(dmesg -l err --since=\"1 hour ago\" | wc -l)\n    local warnings=$(dmesg -l warn --since=\"1 hour ago\" | wc -l)\n    local timestamp=$(date +%s)\n\n    # Output in Prometheus format\n    echoÂ \"kernel_errors_total $errorsÂ $timestamp\"\n    echoÂ \"kernel_warnings_total $warningsÂ $timestamp\"\n} \n\n```", "```sh\n      # Check current buffer size\ndmesg | wc -l\n\n# Increase buffer size (temporary)\nsudo dmesg -s 1048576\n\n# Make permanent (add to kernel parameters)\n# Add to GRUB: log_buf_len=1048576 \n\n```", "```sh\n      # Check if non-root can read dmesg\ndmesg >/dev/null 2>&1 && echoÂ \"Can read dmesg\" || echoÂ \"Cannot read dmesg\"\n\n# Check kernel parameter\ncat /proc/sys/kernel/dmesg_restrict\n\n# Allow non-root users (temporary)\nsudo sysctl kernel.dmesg_restrict=0\n\n# Make permanent\nechoÂ \"kernel.dmesg_restrict = 0\" | sudo tee -a /etc/sysctl.conf \n\n```", "```sh\n      # Check available facilities and levels\ndmesg --help | grep -A 20 \"supported facilities\"\n\n# Test filtering\ndmesg -l err | head -5\ndmesg -f kern | head -5\n\n# Check if systemd is interfering\nsystemctl status systemd-journald \n\n```", "```sh\n      # Process large buffers efficientlyprocess_large_dmesg() {\n    # Use streaming instead of loading all into memory\n    dmesg | while IFS= read -r line; do\n        # Process line by line\n        echoÂ \"$line\" | grep -q \"error\" && echoÂ \"Error: $line\"\n    done\n} \n\n```", "```sh\n      # Use specific filters instead of post-processing\ndmesg -l err               # Better than dmesg | grep -i error\ndmesg --since=\"1 hour ago\"Â # Better than dmesg | filtering by time \n\n```", "```sh\n      # Create cron job for regular checks# 0 */4 * * * /usr/local/bin/check_dmesg_errors.sh# Create check script#!/bin/bash\nerrors=$(dmesg -l err --since=\"4 hours ago\" | wc -l)\nif [ $errors -gt 0 ]; then\n    dmesg -l err --since=\"4 hours ago\" | mail -s \"Kernel Errors Detected\" admin@domain.com\nfi \n\n```", "```sh\n      # Save important messagessave_important_messages() {\n    local date_str=$(date '+%Y%m%d')\n    dmesg -l err,crit,alert,emerg > \"/var/log/kernel_errors_$date_str.log\"\n} \n\n```", "```sh\n      # Document system eventsdocument_system_event() {\n    local event=\"$1\"\n    local logfile=\"/var/log/system_events.log\"\n\n    echoÂ \"$(date): $event\" >> \"$logfile\"\n    echoÂ \"=== dmesg at time of event ===\" >> \"$logfile\"\n    dmesg -T | tail -20 >> \"$logfile\"\n    echoÂ \"=================================\" >> \"$logfile\"\n} \n\n```"]