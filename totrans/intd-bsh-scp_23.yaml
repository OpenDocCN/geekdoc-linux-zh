- en: Redirection in Bash
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Bash 中的重定向
- en: A Linux superuser must have a good knowledge of pipes and redirection in Bash.
    It is an essential component of the system and is often helpful in the field of
    Linux System Administration.
  id: totrans-1
  prefs: []
  type: TYPE_NORMAL
  zh: Linux 系统管理员必须对 Bash 中的管道和重定向有很好的了解。它是系统的一个基本组成部分，并且在 Linux 系统管理领域经常很有帮助。
- en: When you run a command like `ls`, `cat`, etc, you get some output on the terminal.
    If you write a wrong command, pass a wrong flag or a wrong command-line argument,
    you get error output on the terminal. In both the cases, you are given some text.
    It may seem like "just text" to you, but the system treats this text differently.
    This identifier is known as a File Descriptor (fd).
  id: totrans-2
  prefs: []
  type: TYPE_NORMAL
  zh: 当你运行像 `ls`、`cat` 等命令时，你会在终端上得到一些输出。如果你输入了错误的命令，传递了错误的标志或命令行参数，你会在终端上得到错误输出。在这两种情况下，你都会得到一些文本。这可能看起来像是“仅仅是文本”，但系统会以不同的方式处理这些文本。这个标识符被称为文件描述符（fd）。
- en: In Linux, there are 3 File Descriptors, **STDIN** (0); **STDOUT** (1) and **STDERR**
    (2).
  id: totrans-3
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Linux 中，有 3 个文件描述符，**STDIN**（0）；**STDOUT**（1）和**STDERR**（2）。
- en: '**STDIN** (fd: 0): Manages the input in the terminal.'
  id: totrans-4
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**STDIN**（fd: 0）：管理终端中的输入。'
- en: '**STDOUT** (fd: 1): Manages the output text in the terminal.'
  id: totrans-5
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**STDOUT**（fd: 1）：管理终端中的输出文本。'
- en: '**STDERR** (fd: 2): Manages the error text in the terminal.'
  id: totrans-6
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**STDERR**（fd: 2）：管理终端中的错误文本。'
- en: Difference between Pipes and Redirections
  id: totrans-7
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管道和重定向的区别
- en: Both *pipes* and *redirections* redirect streams `(file descriptor)` of process
    being executed. The main difference is that *redirections* deal with `files stream`,
    sending the output stream to a file or sending the content of a given file to
    the input stream of the process.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: '**管道**和**重定向**都会重定向正在执行的进程的流（文件描述符）。主要区别在于**重定向**处理**文件流**，将输出流发送到文件或将给定文件的
    内容发送到进程的输入流。'
- en: On the other hand a pipe connects two commands by sending the output stream
    of the first one to the input stream of the second one. without any redirections
    specified.
  id: totrans-9
  prefs: []
  type: TYPE_NORMAL
  zh: 另一方面，管道通过将第一个命令的输出流发送到第二个命令的输入流来连接两个命令，而不指定任何重定向。
- en: Redirection in Bash
  id: totrans-10
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: Bash 中的重定向
- en: STDIN (Standard Input)
  id: totrans-11
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 标准输入（STDIN）
- en: When you enter some input text for a command that asks for it, you are actually
    entering the text to the **STDIN** file descriptor. Run the `cat` command without
    any command-line arguments. It may seem that the process has paused but in fact
    it's `cat` asking for **STDIN**. `cat` is a simple program and will print the
    text passed to **STDIN**. However, you can extend the use case by redirecting
    the input to the commands that take **STDIN**.
  id: totrans-12
  prefs: []
  type: TYPE_NORMAL
  zh: 当你为请求输入文本的命令输入一些输入文本时，你实际上是将文本输入到 **STDIN** 文件描述符中。运行没有任何命令行参数的 `cat` 命令。它可能看起来像进程已经暂停了，但实际上是
    `cat` 正在请求 **STDIN**。`cat` 是一个简单的程序，它会打印传递给 **STDIN** 的文本。然而，你可以通过将输入重定向到接受 **STDIN**
    的命令来扩展用例。
- en: 'Example with `cat`:'
  id: totrans-13
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `cat` 的示例：
- en: '[PRE0]'
  id: totrans-14
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'This will simply print the provided text on the terminal screen:'
  id: totrans-15
  prefs: []
  type: TYPE_NORMAL
  zh: 这个命令将简单地将在终端屏幕上打印提供的文本：
- en: '[PRE1]'
  id: totrans-16
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'The same can be done with other commands that take input via STDIN. Like, `wc`:'
  id: totrans-17
  prefs: []
  type: TYPE_NORMAL
  zh: 同样，你也可以用其他通过 STDIN 获取输入的命令来做这件事。比如，`wc`：
- en: '[PRE2]'
  id: totrans-18
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The `-l` flag with `wc` counts the number of lines. This block of bash code
    will print the number of lines to the terminal screen:'
  id: totrans-19
  prefs: []
  type: TYPE_NORMAL
  zh: '`wc` 的 `-l` 标志计算行数。这个 bash 代码块将打印行数到终端屏幕：'
- en: '[PRE3]'
  id: totrans-20
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: STDOUT (Standard Output)
  id: totrans-21
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 标准输出（STDOUT）
- en: The normal non-error text on your terminal screen is printed via the **STDOUT**
    file descriptor. The **STDOUT** of a command can be redirected into a file, in
    such a way that the output of the command is written to a file instead of being
    printed on the terminal screen. This is done simply with the help of `>` and `>>`
    operators.
  id: totrans-22
  prefs: []
  type: TYPE_NORMAL
  zh: 你终端屏幕上的正常非错误文本是通过 **STDOUT** 文件描述符打印的。命令的 **STDOUT** 可以重定向到文件，这样命令的输出就会写入文件而不是打印在终端屏幕上。这可以通过
    `>` 和 `>>` 运算符简单地完成。
- en: 'Example:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE4]'
  id: totrans-24
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: The above command will not print "Hello World" on the terminal screen, it will
    instead create a file called `file.txt` and will write the "Hello World" string
    to it. This can be verified by running the `cat` command on the `file.txt` file.
  id: totrans-25
  prefs: []
  type: TYPE_NORMAL
  zh: 上述命令不会在终端屏幕上打印“Hello World”，而是会创建一个名为 `file.txt` 的文件，并将“Hello World”字符串写入其中。这可以通过在
    `file.txt` 文件上运行 `cat` 命令来验证。
- en: '[PRE5]'
  id: totrans-26
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: However, everytime you redirect the **STDOUT** of any command multiple times
    to the same file, it will remove the existing contents of the file to write the
    new ones.
  id: totrans-27
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，每次你将任何命令的 **STDOUT** 多次重定向到同一个文件时，它都会删除文件中的现有内容以写入新的内容。
- en: 'Example:'
  id: totrans-28
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE6]'
  id: totrans-29
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'On running `cat` on `file.txt` file:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 在对 `file.txt` 文件运行 `cat` 命令时：
- en: '[PRE7]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: You will only get the "How are you?" string printed.
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 你只会得到“你好吗？”字符串打印出来。
- en: '[PRE8]'
  id: totrans-33
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: This is because the "Hello World" string has been overwritten. This behaviour
    can be avoided using the `>>` operator.
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: 这是因为 "Hello World" 字符串已被覆盖。这种行为可以通过使用 `>>` 操作符来避免。
- en: 'The above example can be written as:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 上述示例可以写成如下形式：
- en: '[PRE9]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: On running `cat` on the `file.txt` file, you will get the desired result.
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 在对 `file.txt` 文件运行 `cat` 命令时，你会得到期望的结果。
- en: '[PRE10]'
  id: totrans-38
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Alternatively, the redirection operator for **STDOUT** can also be written as
    `1>`. Like,
  id: totrans-39
  prefs: []
  type: TYPE_NORMAL
  zh: 或者，**STDOUT** 的重定向操作符也可以写成 `1>`。例如，
- en: '[PRE11]'
  id: totrans-40
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: STDERR (Standard Error)
  id: totrans-41
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: STDERR (标准错误)
- en: 'The error text on the terminal screen is printed via the **STDERR** of the
    command. For example:'
  id: totrans-42
  prefs: []
  type: TYPE_NORMAL
  zh: 终端屏幕上的错误文本是通过命令的 **STDERR** 打印的。例如：
- en: '[PRE12]'
  id: totrans-43
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: would give an error messages. This error message is the **STDERR** of the command.
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 会给出错误信息。这个错误信息是命令的 **STDERR**。
- en: '**STDERR** can be redirected using the `2>` operator.'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: '**STDERR** 可以使用 `2>` 操作符进行重定向。'
- en: '[PRE13]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: This command will redirect the error message to the `error.txt` file and write
    it to it. This can be verified by running the `cat` command on the `error.txt`
    file.
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将错误信息重定向到 `error.txt` 文件并写入其中。这可以通过在 `error.txt` 文件上运行 `cat` 命令来验证。
- en: You can also use the `2>>` operator for **STDERR** just like you used `>>` for
    **STDOUT**.
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以像使用 `>>` 操作符来处理 **STDOUT** 一样，使用 `2>>` 操作符来处理 **STDERR**。
- en: Error messages in Bash Scripts can be undesirable sometimes. You can choose
    to ignore them by redirecting the error message to the `/dev/null` file. `/dev/null`
    is pseudo-device that takes in text and then immediately discards it.
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: 在 Bash 脚本中，错误信息有时可能是不希望的。你可以选择通过将错误信息重定向到 `/dev/null` 文件来忽略它们。`/dev/null` 是一个伪设备，它接收文本然后立即丢弃它。
- en: 'The above example can be written follows to ignore the error text completely:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 上述示例可以写成如下形式以完全忽略错误文本：
- en: '[PRE14]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: Of course, you can redirect both **STDOUT** and **STDERR** for the same command
    or script.
  id: totrans-52
  prefs: []
  type: TYPE_NORMAL
  zh: 当然，你可以将同一个命令或脚本的 **STDOUT** 和 **STDERR** 都重定向到同一个文件。
- en: '[PRE15]'
  id: totrans-53
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: Both of them can be redirected to the same file as well.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 它们都可以重定向到同一个文件。
- en: '[PRE16]'
  id: totrans-55
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: There is also a shorter way to do this.
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 还有更简单的方法来做这件事。
- en: '[PRE17]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: Piping
  id: totrans-58
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 管道操作
- en: So far we have seen how to redirect the **STDOUT**, **STDIN** and **STDOUT**
    to and from a file. To concatenate the output of program *(command)* as the input
    of another program *(command)* you can use a vertical bar `|`.
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 到目前为止，我们已经看到了如何将 **STDOUT**、**STDIN** 和 **STDOUT** 重定向到和从文件。要连接程序 *(命令)* 的输出作为另一个程序
    *(命令)* 的输入，你可以使用垂直线 `|`。
- en: 'Example:'
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE18]'
  id: totrans-61
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: This command will list the files in the current directory and pass output to
    *`grep`* command which then filter the output to only show the files that contain
    the string ".txt".
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 此命令将列出当前目录中的文件，并将输出传递给 *`grep`* 命令，然后过滤输出，只显示包含字符串 ".txt" 的文件。
- en: 'Syntax:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 语法：
- en: '[PRE19]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: You can also build arbitrary chains of commands by piping them together to achieve
    a powerful result.
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 你也可以通过将它们管道连接起来来构建任意命令链，以实现强大的结果。
- en: 'This example creates a listing of every user which owns a file in a given directory
    as well as how many files and directories they own:'
  id: totrans-66
  prefs: []
  type: TYPE_NORMAL
  zh: 此示例创建了一个列表，列出给定目录中每个用户拥有的文件以及他们拥有的文件和目录数量：
- en: '[PRE20]'
  id: totrans-67
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: 'Output:'
  id: totrans-68
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '[PRE21]'
  id: totrans-69
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: HereDocument
  id: totrans-70
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: HereDocument
- en: The symbol `<<` can be used to create a temporary file [heredoc] and redirect
    from it at the command line.
  id: totrans-71
  prefs: []
  type: TYPE_NORMAL
  zh: 符号 `<<` 可以用来创建一个临时文件 [heredoc] 并在命令行中从该文件重定向。
- en: '[PRE22]'
  id: totrans-72
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: 'Note here that `EOF` represents the delimiter (end of file) of the heredoc.
    In fact, we can use any alphanumeric word in its place to signify the start and
    the end of the file. For instance, this is a valid heredoc:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: 注意，这里的 `EOF` 代表 heredoc 的分隔符（文件结束）。实际上，我们可以用任何字母数字词来代替它，以表示文件的开始和结束。例如，这是一个有效的
    heredoc：
- en: '[PRE23]'
  id: totrans-74
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: Effectively it will appear as if the contents of the heredoc are piped into
    the command. This can make the script very clean if multiple lines need to be
    piped into a program.
  id: totrans-75
  prefs: []
  type: TYPE_NORMAL
  zh: 实际上，这会看起来像是 heredoc 的内容被管道输入到命令中。如果需要将多行管道输入到程序中，这可以使脚本非常干净。
- en: 'Further, we can attach more pipes as shown:'
  id: totrans-76
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，我们还可以附加更多的管道，如下所示：
- en: '[PRE24]'
  id: totrans-77
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: Also, pre-defined variables can be used inside the heredocs.
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 此外，在 heredocs 中也可以使用预定义的变量。
- en: HereString
  id: totrans-79
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: HereString
- en: Herestrings are quite similar to heredocs but use `<<<`. These are used for
    single line strings that have to be piped into some program. This looks cleaner
    that heredocs as we don't have to specify the delimiter.
  id: totrans-80
  prefs: []
  type: TYPE_NORMAL
  zh: Herestrings 与 heredocs 非常相似，但使用 `<<<`。这些用于需要管道到某个程序的单一行字符串。与 heredocs 相比，这看起来更干净，因为我们不需要指定分隔符。
- en: '[PRE25]'
  id: totrans-81
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: Just like heredocs, herestrings can contain variables.
  id: totrans-82
  prefs: []
  type: TYPE_NORMAL
  zh: 就像 heredocs 一样，herestrings 也可以包含变量。
- en: Summary
  id: totrans-83
  prefs:
  - PREF_H2
  type: TYPE_NORMAL
  zh: 摘要
- en: '| **Operator** | **Description** |'
  id: totrans-84
  prefs: []
  type: TYPE_TB
  zh: '| **操作符** | **描述** |'
- en: '| :-- | :-- |'
  id: totrans-85
  prefs: []
  type: TYPE_TB
  zh: '| :-- | :-- |'
- en: '| `>` | `Save output to a file` |'
  id: totrans-86
  prefs: []
  type: TYPE_TB
  zh: '| `>` | `将输出保存到文件` |'
- en: '| `>>` | `Append output to a file` |'
  id: totrans-87
  prefs: []
  type: TYPE_TB
  zh: '| `>>` | 将输出追加到文件 |'
- en: '| `<` | `Read input from a file` |'
  id: totrans-88
  prefs: []
  type: TYPE_TB
  zh: '| `<` | 从文件读取输入 |'
- en: '| `2>` | `Redirect error messages` |'
  id: totrans-89
  prefs: []
  type: TYPE_TB
  zh: '| `2>` | 重定向错误信息 |'
- en: '| `&#124;` | `Send the output from one program as input to another program`
    |'
  id: totrans-90
  prefs: []
  type: TYPE_TB
  zh: '| `&#124;` | 将一个程序的输出作为另一个程序的输入 |'
- en: '| `<<` | `Pipe multiple lines into a program cleanly` |'
  id: totrans-91
  prefs: []
  type: TYPE_TB
  zh: '| `<<` | 清洁地将多行管道输入到程序 |'
- en: '| `<<<` | `Pipe a single line into a program cleanly` |'
  id: totrans-92
  prefs: []
  type: TYPE_TB
  zh: '| `<<<` | 清洁地将单行管道输入到程序 |'
