<html><head></head><body>
    <div style="page-break-after: always;"/>
    <h1>The <code>dmesg</code> command</h1>
    <p>The <code>dmesg</code> command displays messages from the kernel ring buffer. It shows boot messages, hardware detection, driver loading, and system events. This is essential for troubleshooting hardware issues, driver problems, and understanding system startup processes.</p>
    <h2>Syntax</h2>
    <pre>
      <code class="language- hljs " data-lang="">dmesg [options]
</code>
    </pre>
    <h2>Key Features</h2>
    <ul>
      <li><strong>Kernel Messages</strong>: Shows kernel ring buffer contents</li>
      <li><strong>Boot Information</strong>: Hardware detection and driver loading</li>
      <li><strong>Real-time Monitoring</strong>: Can follow new messages</li>
      <li><strong>Filtering Options</strong>: Filter by facility, level, or time</li>
      <li><strong>Multiple Formats</strong>: Human-readable and raw formats</li>
    </ul>
    <h2>Basic Usage</h2>
    <h3>Show All Messages</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Display all kernel messages</span>
dmesg

<span class="hljs-comment"># Display with human-readable timestamps</span>
dmesg -T

<span class="hljs-comment"># Display last 20 lines</span>
dmesg | tail -20

<span class="hljs-comment"># Display first 20 lines (boot messages)</span>
dmesg | head -20
</code>
    </pre>
    <h3>Follow New Messages</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Follow new kernel messages (like tail -f)</span>
dmesg -w

<span class="hljs-comment"># Follow with timestamps</span>
dmesg -T -w

<span class="hljs-comment"># Follow last 10 lines and continue</span>
dmesg | tail -10 &amp;&amp; dmesg -w
</code>
    </pre>
    <h2>Message Levels and Facilities</h2>
    <h3>Message Levels</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Emergency messages (level 0)</span>
dmesg -l emerg

<span class="hljs-comment"># Alert messages (level 1)</span>
dmesg -l alert

<span class="hljs-comment"># Critical messages (level 2)</span>
dmesg -l crit

<span class="hljs-comment"># Error messages (level 3)</span>
dmesg -l err

<span class="hljs-comment"># Warning messages (level 4)</span>
dmesg -l warn

<span class="hljs-comment"># Notice messages (level 5)</span>
dmesg -l notice

<span class="hljs-comment"># Info messages (level 6)</span>
dmesg -l info

<span class="hljs-comment"># Debug messages (level 7)</span>
dmesg -l debug
</code>
    </pre>
    <h3>Multiple Levels</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Show errors and warnings</span>
dmesg -l err,warn

<span class="hljs-comment"># Show critical and above (crit, alert, emerg)</span>
dmesg -l crit+

<span class="hljs-comment"># Show warnings and below (warn, notice, info, debug)</span>
dmesg -l warn-
</code>
    </pre>
    <h3>Facilities</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Kernel messages</span>
dmesg -f kern

<span class="hljs-comment"># User-space messages</span>
dmesg -f user

<span class="hljs-comment"># Mail system messages</span>
dmesg -f mail

<span class="hljs-comment"># System daemons</span>
dmesg -f daemon

<span class="hljs-comment"># Authorization messages</span>
dmesg -f auth

<span class="hljs-comment"># Syslog messages</span>
dmesg -f syslog
</code>
    </pre>
    <h2>Common Options</h2>
    <h3>Display Options</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># -T: Human-readable timestamps</span>
dmesg -T

<span class="hljs-comment"># -t: Don't show timestamps</span>
dmesg -t

<span class="hljs-comment"># -x: Decode facility and level to human-readable</span>
dmesg -x

<span class="hljs-comment"># -H: Enable human-readable output</span>
dmesg -H

<span class="hljs-comment"># -k: Show kernel messages only</span>
dmesg -k
</code>
    </pre>
    <h3>Buffer Options</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># -c: Clear ring buffer after reading</span>
sudo dmesg -c

<span class="hljs-comment"># -C: Clear ring buffer</span>
sudo dmesg -C

<span class="hljs-comment"># -s: Buffer size</span>
dmesg -s 65536

<span class="hljs-comment"># -n: Set console log level</span>
sudo dmesg -n 1
</code>
    </pre>
    <h2>Practical Examples</h2>
    <h3>1. Hardware Detection</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Check USB device detection</span>
dmesg | grep -i usb

<span class="hljs-comment"># Check network interface detection</span>
dmesg | grep -i eth

<span class="hljs-comment"># Check disk detection</span>
dmesg | grep -i -E <span class="hljs-string">"(sda|sdb|sdc|nvme)"</span>

<span class="hljs-comment"># Check memory detection</span>
dmesg | grep -i memory

<span class="hljs-comment"># Check CPU detection</span>
dmesg | grep -i cpu
</code>
    </pre>
    <h3>2. Driver Loading</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Check loaded drivers</span>
dmesg | grep -i driver

<span class="hljs-comment"># Check specific driver (e.g., nvidia)</span>
dmesg | grep -i nvidia

<span class="hljs-comment"># Check wireless driver</span>
dmesg | grep -i wifi

<span class="hljs-comment"># Check bluetooth driver</span>
dmesg | grep -i bluetooth

<span class="hljs-comment"># Check sound driver</span>
dmesg | grep -i audio
</code>
    </pre>
    <h3>3. Error Debugging</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Show only error messages</span>
dmesg -l err

<span class="hljs-comment"># Show errors and warnings</span>
dmesg -l err,warn

<span class="hljs-comment"># Search for specific errors</span>
dmesg | grep -i error

<span class="hljs-comment"># Search for failed operations</span>
dmesg | grep -i fail

<span class="hljs-comment"># Search for timeout issues</span>
dmesg | grep -i timeout
</code>
    </pre>
    <h3>4. Boot Process Analysis</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Show boot messages with timestamps</span>
dmesg -T | head -50

<span class="hljs-comment"># Find boot completion time</span>
dmesg | grep -i <span class="hljs-string">"boot"</span>

<span class="hljs-comment"># Check service startup</span>
dmesg | grep -i systemd

<span class="hljs-comment"># Check filesystem mounting</span>
dmesg | grep -i mount

<span class="hljs-comment"># Check network initialization</span>
dmesg | grep -i network
</code>
    </pre>
    <h2>Time-Based Filtering</h2>
    <h3>Recent Messages</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Messages from last 10 minutes</span>
dmesg --since=<span class="hljs-string">"10 minutes ago"</span>

<span class="hljs-comment"># Messages from last hour</span>
dmesg --since=<span class="hljs-string">"1 hour ago"</span>

<span class="hljs-comment"># Messages from today</span>
dmesg --since=<span class="hljs-string">"today"</span>

<span class="hljs-comment"># Messages from specific time</span>
dmesg --since=<span class="hljs-string">"2023-01-01 00:00:00"</span>
</code>
    </pre>
    <h3>Time Ranges</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Messages between specific times</span>
dmesg --since=<span class="hljs-string">"2023-01-01"</span> --until=<span class="hljs-string">"2023-01-02"</span>

<span class="hljs-comment"># Messages from last boot</span>
dmesg --since=<span class="hljs-string">"last boot"</span>

<span class="hljs-comment"># Messages from specific duration</span>
dmesg --since=<span class="hljs-string">"30 minutes ago"</span> --until=<span class="hljs-string">"10 minutes ago"</span>
</code>
    </pre>
    <h2>Advanced Filtering</h2>
    <h3>1. Combining Filters</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Errors from last hour</span>
dmesg -l err --since=<span class="hljs-string">"1 hour ago"</span>

<span class="hljs-comment"># Kernel warnings with timestamps</span>
dmesg -T -l warn -f kern

<span class="hljs-comment"># USB-related errors</span>
dmesg -l err | grep -i usb

<span class="hljs-comment"># Network errors from today</span>
dmesg --since=<span class="hljs-string">"today"</span> | grep -i -E <span class="hljs-string">"(network|eth|wifi)"</span>
</code>
    </pre>
    <h3>2. Output Formatting</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># JSON format</span>
dmesg --json

<span class="hljs-comment"># Raw format (no timestamp processing)</span>
dmesg -r

<span class="hljs-comment"># Colored output (if supported)</span>
dmesg --color=always

<span class="hljs-comment"># No pager</span>
dmesg --nopager
</code>
    </pre>
    <h3>3. Custom Formatting</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Extract specific information</span><span class="hljs-function"><span class="hljs-title">extract_usb_devices</span></span>() {
    dmesg | grep -E <span class="hljs-string">"usb.*: New USB device"</span> | \
    sed -n <span class="hljs-string">'s/.*New USB device found, idVendor=\([^,]*\), idProduct=\([^ ]*\).*/Vendor: \1, Product: \2/p'</span>
}

extract_usb_devices
</code>
    </pre>
    <h2>Monitoring and Alerting</h2>
    <h3>1. Real-time Monitoring</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Monitor for specific events</span><span class="hljs-function"><span class="hljs-title">monitor_errors</span></span>() {
    dmesg -w -l err | <span class="hljs-keyword">while</span>¬†<span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"<span class="hljs-variable">$(date)</span>: <span class="hljs-variable">$line</span>"</span>
        <span class="hljs-comment"># Send alert</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"<span class="hljs-variable">$line</span>"</span> | mail -s <span class="hljs-string">"Kernel Error Alert"</span> admin@domain.com
    <span class="hljs-keyword">done</span>
}

<span class="hljs-comment"># Monitor USB connections</span>
<span class="hljs-function"><span class="hljs-title">monitor_usb</span></span>() {
    dmesg -w | grep --line-buffered -i usb | <span class="hljs-keyword">while</span>¬†<span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"USB Event: <span class="hljs-variable">$line</span>"</span>
    <span class="hljs-keyword">done</span>
}
</code>
    </pre>
    <h3>2. Log Analysis Scripts</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-meta">#!/bin/bash</span><span class="hljs-comment"># Analyze kernel messages for issues</span><span class="hljs-function"><span class="hljs-title">analyze_dmesg</span></span>() {
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"=== Kernel Message Analysis ==="</span>
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Generated: <span class="hljs-variable">$(date)</span>"</span>
    <span class="hljs-built_in">echo</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Error Messages:"</span>
    dmesg -l err | tail -10
    <span class="hljs-built_in">echo</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Warning Messages:"</span>
    dmesg -l warn | tail -10
    <span class="hljs-built_in">echo</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Recent Hardware Events:"</span>
    dmesg --since=<span class="hljs-string">"1 hour ago"</span> | grep -i -E <span class="hljs-string">"(usb|disk|network|memory)"</span> | tail -10
    <span class="hljs-built_in">echo</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Driver Loading Issues:"</span>
    dmesg | grep -i -E <span class="hljs-string">"(failed|error|timeout)"</span> | grep -i driver | tail -5
}

analyze_dmesg &gt; kernel_analysis.txt
</code>
    </pre>
    <h3>3. System Health Check</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-meta">#!/bin/bash</span><span class="hljs-comment"># Check system health using dmesg</span><span class="hljs-function"><span class="hljs-title">check_system_health</span></span>() {
    <span class="hljs-built_in">local</span> issues=0

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"=== System Health Check ==="</span>

    <span class="hljs-comment"># Check for critical errors</span>
    critical_errors=$(dmesg -l crit,alert,emerg --since=<span class="hljs-string">"24 hours ago"</span> | wc -l)
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$critical_errors</span> -gt 0 ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚ö†Ô∏è  <span class="hljs-variable">$critical_errors</span> critical errors found in last 24 hours"</span>
        ((issues++))
    <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚úÖ No critical errors in last 24 hours"</span>
    <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># Check for hardware errors</span>
    hw_errors=$(dmesg --since=<span class="hljs-string">"24 hours ago"</span> | grep -i -c -E <span class="hljs-string">"(hardware error|machine check|MCE)"</span>)
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$hw_errors</span> -gt 0 ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚ö†Ô∏è  <span class="hljs-variable">$hw_errors</span> hardware errors detected"</span>
        ((issues++))
    <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚úÖ No hardware errors detected"</span>
    <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># Check for out of memory</span>
    oom_events=$(dmesg --since=<span class="hljs-string">"24 hours ago"</span> | grep -i -c <span class="hljs-string">"out of memory"</span>)
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$oom_events</span> -gt 0 ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚ö†Ô∏è  <span class="hljs-variable">$oom_events</span> out of memory events"</span>
        ((issues++))
    <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚úÖ No out of memory events"</span>
    <span class="hljs-keyword">fi</span>

    <span class="hljs-comment"># Check for filesystem errors</span>
    fs_errors=$(dmesg --since=<span class="hljs-string">"24 hours ago"</span> | grep -i -c -E <span class="hljs-string">"(filesystem error|ext[234] error|xfs error)"</span>)
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$fs_errors</span> -gt 0 ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚ö†Ô∏è  <span class="hljs-variable">$fs_errors</span> filesystem errors"</span>
        ((issues++))
    <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚úÖ No filesystem errors"</span>
    <span class="hljs-keyword">fi</span>

    <span class="hljs-built_in">echo</span>
    <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$issues</span> -eq 0 ]; <span class="hljs-keyword">then</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"üéâ System appears healthy!"</span>
    <span class="hljs-keyword">else</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"‚ö†Ô∏è  Found <span class="hljs-variable">$issues</span> types of issues - check details above"</span>
    <span class="hljs-keyword">fi</span>
}

check_system_health
</code>
    </pre>
    <h2>Common Use Cases</h2>
    <h3>1. USB Device Troubleshooting</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Monitor USB device connections</span><span class="hljs-function"><span class="hljs-title">monitor_usb_debug</span></span>() {
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Monitoring USB events (Ctrl+C to stop)..."</span>
    dmesg -w | grep --line-buffered -i usb | <span class="hljs-keyword">while</span>¬†<span class="hljs-built_in">read</span> line; <span class="hljs-keyword">do</span>
        timestamp=$(date <span class="hljs-string">'+%Y-%m-%d %H:%M:%S'</span>)
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"[<span class="hljs-variable">$timestamp</span>] <span class="hljs-variable">$line</span>"</span>
    <span class="hljs-keyword">done</span>
}

<span class="hljs-comment"># Check USB device history</span>
<span class="hljs-function"><span class="hljs-title">usb_device_history</span></span>() {
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"USB Device Connection History:"</span>
    dmesg | grep -i <span class="hljs-string">"usb.*: New USB device"</span> | tail -10
    <span class="hljs-built_in">echo</span>
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"USB Device Disconnections:"</span>
    dmesg | grep -i <span class="hljs-string">"usb.*disconnect"</span> | tail -10
}
</code>
    </pre>
    <h3>2. Network Interface Issues</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Check network interface events</span><span class="hljs-function"><span class="hljs-title">check_network_issues</span></span>() {
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Network Interface Events:"</span>
    dmesg | grep -i -E <span class="hljs-string">"(eth[0-9]|wlan[0-9]|enp|wlp)"</span> | tail -10
    <span class="hljs-built_in">echo</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Network Driver Issues:"</span>
    dmesg | grep -i -E <span class="hljs-string">"network.*error|ethernet.*error"</span> | tail -5
    <span class="hljs-built_in">echo</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Link Status Changes:"</span>
    dmesg | grep -i <span class="hljs-string">"link"</span> | tail -10
}
</code>
    </pre>
    <h3>3. Storage Device Monitoring</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Check disk health and errors</span><span class="hljs-function"><span class="hljs-title">check_storage_health</span></span>() {
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Storage Device Detection:"</span>
    dmesg | grep -i -E <span class="hljs-string">"(sda|sdb|nvme)"</span> | grep -i <span class="hljs-string">"sectors"</span> | tail -5
    <span class="hljs-built_in">echo</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Storage Errors:"</span>
    dmesg | grep -i -E <span class="hljs-string">"(I/O error|Medium Error|critical medium error)"</span> | tail -5
    <span class="hljs-built_in">echo</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Filesystem Events:"</span>
    dmesg | grep -i -E <span class="hljs-string">"(mounted|unmounted|remounted)"</span> | tail -10
}
</code>
    </pre>
    <h2>Integration with Other Tools</h2>
    <h3>1. Combining with journalctl</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Compare kernel messages</span><span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"=== dmesg output ==="</span>
dmesg --since=<span class="hljs-string">"1 hour ago"</span> | head -5

<span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"=== journalctl kernel messages ==="</span>
journalctl -k --since=<span class="hljs-string">"1 hour ago"</span> | head -5
</code>
    </pre>
    <h3>2. Log File Integration</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Save dmesg to file with rotation</span><span class="hljs-function"><span class="hljs-title">save_dmesg_log</span></span>() {
    <span class="hljs-built_in">local</span> logfile=<span class="hljs-string">"/var/log/dmesg.log"</span>
    <span class="hljs-built_in">local</span> timestamp=$(date <span class="hljs-string">'+%Y-%m-%d %H:%M:%S'</span>)

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"[<span class="hljs-variable">$timestamp</span>] === dmesg snapshot ==="</span> &gt;&gt; <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>
    dmesg -T &gt;&gt; <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>

    <span class="hljs-comment"># Rotate if file gets too large</span>
    <span class="hljs-keyword">if</span> [ $(<span class="hljs-built_in">stat</span> -f%z <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span> 2&gt;/dev/null || <span class="hljs-built_in">stat</span> -c%s <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>) -gt 10485760 ]; <span class="hljs-keyword">then</span>
        mv <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>¬†<span class="hljs-string">"<span class="hljs-variable">$logfile</span>.old"</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Log rotated at <span class="hljs-variable">$timestamp</span>"</span> &gt; <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>
    <span class="hljs-keyword">fi</span>
}
</code>
    </pre>
    <h3>3. Monitoring System Integration</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Create metrics for monitoring systems</span><span class="hljs-function"><span class="hljs-title">create_dmesg_metrics</span></span>() {
    <span class="hljs-built_in">local</span> errors=$(dmesg -l err --since=<span class="hljs-string">"1 hour ago"</span> | wc -l)
    <span class="hljs-built_in">local</span> warnings=$(dmesg -l warn --since=<span class="hljs-string">"1 hour ago"</span> | wc -l)
    <span class="hljs-built_in">local</span> timestamp=$(date +%s)

    <span class="hljs-comment"># Output in Prometheus format</span>
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"kernel_errors_total <span class="hljs-variable">$errors</span>¬†<span class="hljs-variable">$timestamp</span>"</span>
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"kernel_warnings_total <span class="hljs-variable">$warnings</span>¬†<span class="hljs-variable">$timestamp</span>"</span>
}
</code>
    </pre>
    <h2>Troubleshooting</h2>
    <h3>1. Buffer Size Issues</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Check current buffer size</span>
dmesg | wc -l

<span class="hljs-comment"># Increase buffer size (temporary)</span>
sudo dmesg -s 1048576

<span class="hljs-comment"># Make permanent (add to kernel parameters)</span>
<span class="hljs-comment"># Add to GRUB: log_buf_len=1048576</span>
</code>
    </pre>
    <h3>2. Permission Issues</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Check if non-root can read dmesg</span>
dmesg &gt;/dev/null 2&gt;&amp;1 &amp;&amp; <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Can read dmesg"</span> || <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Cannot read dmesg"</span>

<span class="hljs-comment"># Check kernel parameter</span>
cat /proc/sys/kernel/dmesg_restrict

<span class="hljs-comment"># Allow non-root users (temporary)</span>
sudo sysctl kernel.dmesg_restrict=0

<span class="hljs-comment"># Make permanent</span>
<span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"kernel.dmesg_restrict = 0"</span> | sudo tee -a /etc/sysctl.conf
</code>
    </pre>
    <h3>3. Message Filtering Issues</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Check available facilities and levels</span>
dmesg --<span class="hljs-built_in">help</span> | grep -A 20 <span class="hljs-string">"supported facilities"</span>

<span class="hljs-comment"># Test filtering</span>
dmesg -l err | head -5
dmesg -f kern | head -5

<span class="hljs-comment"># Check if systemd is interfering</span>
systemctl status systemd-journald
</code>
    </pre>
    <h2>Performance Considerations</h2>
    <h3>1. Large Buffer Handling</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Process large buffers efficiently</span><span class="hljs-function"><span class="hljs-title">process_large_dmesg</span></span>() {
    <span class="hljs-comment"># Use streaming instead of loading all into memory</span>
    dmesg | <span class="hljs-keyword">while</span> IFS= <span class="hljs-built_in">read</span> -r line; <span class="hljs-keyword">do</span>
        <span class="hljs-comment"># Process line by line</span>
        <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"<span class="hljs-variable">$line</span>"</span> | grep -q <span class="hljs-string">"error"</span> &amp;&amp; <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"Error: <span class="hljs-variable">$line</span>"</span>
    <span class="hljs-keyword">done</span>
}
</code>
    </pre>
    <h3>2. Efficient Searching</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Use specific filters instead of post-processing</span>
dmesg -l err               <span class="hljs-comment"># Better than dmesg | grep -i error</span>
dmesg --since=<span class="hljs-string">"1 hour ago"</span>¬†<span class="hljs-comment"># Better than dmesg | filtering by time</span>
</code>
    </pre>
    <h2>Best Practices</h2>
    <h3>1. Regular Monitoring</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Create cron job for regular checks</span><span class="hljs-comment"># 0 */4 * * * /usr/local/bin/check_dmesg_errors.sh</span><span class="hljs-comment"># Create check script</span><span class="hljs-meta">#!/bin/bash</span>
errors=$(dmesg -l err --since=<span class="hljs-string">"4 hours ago"</span> | wc -l)
<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$errors</span> -gt 0 ]; <span class="hljs-keyword">then</span>
    dmesg -l err --since=<span class="hljs-string">"4 hours ago"</span> | mail -s <span class="hljs-string">"Kernel Errors Detected"</span> admin@domain.com
<span class="hljs-keyword">fi</span>
</code>
    </pre>
    <h3>2. Log Retention</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Save important messages</span><span class="hljs-function"><span class="hljs-title">save_important_messages</span></span>() {
    <span class="hljs-built_in">local</span> date_str=$(date <span class="hljs-string">'+%Y%m%d'</span>)
    dmesg -l err,crit,alert,emerg &gt; <span class="hljs-string">"/var/log/kernel_errors_<span class="hljs-variable">$date_str</span>.log"</span>
}
</code>
    </pre>
    <h3>3. Documentation</h3>
    <pre>
      <code class="language-bash hljs bash" data-lang="bash"><span class="hljs-comment"># Document system events</span><span class="hljs-function"><span class="hljs-title">document_system_event</span></span>() {
    <span class="hljs-built_in">local</span> event=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>
    <span class="hljs-built_in">local</span> logfile=<span class="hljs-string">"/var/log/system_events.log"</span>

    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"<span class="hljs-variable">$(date)</span>: <span class="hljs-variable">$event</span>"</span> &gt;&gt; <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"=== dmesg at time of event ==="</span> &gt;&gt; <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>
    dmesg -T | tail -20 &gt;&gt; <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>
    <span class="hljs-built_in">echo</span>¬†<span class="hljs-string">"================================="</span> &gt;&gt; <span class="hljs-string">"<span class="hljs-variable">$logfile</span>"</span>
}
</code>
    </pre>
    <h2>Important Notes</h2>
    <ul>
      <li><strong>Root Access</strong>: Some distributions restrict dmesg to root users</li>
      <li><strong>Buffer Size</strong>: Ring buffer has limited size; old messages are overwritten</li>
      <li><strong>Timestamps</strong>: Use <code>-T</code> for human-readable timestamps</li>
      <li><strong>Levels</strong>: Understand message levels for effective filtering</li>
      <li><strong>Real-time</strong>: Use <code>-w</code> for monitoring new messages</li>
      <li><strong>Performance</strong>: Large buffers can impact performance</li>
      <li><strong>Security</strong>: Be cautious about exposing kernel messages</li>
    </ul>
    <p>The <code>dmesg</code> command is essential for system troubleshooting, hardware debugging, and understanding kernel behavior.</p>
    <p>For more details, check the manual: <code>man dmesg</code></p>
  </body></html>