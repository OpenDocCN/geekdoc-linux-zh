<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:epub="http://www.idpf.org/2007/ops" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <title>ch248.xhtml</title>
  <link rel="stylesheet" type="text/css" href="../styles/stylesheet1.css" />
</head>
<body epub:type="bodymatter">
<section id="libcurl-http__versions__md-_-_-versions" class="level1" data-number="247">
<h1 data-number="247">Versions</h1>
<p>Like all Internet protocols, the HTTP protocol has kept evolving over the years and now there are clients and servers distributed over the world and over time that speak different versions with varying levels of success. In order to get libcurl to work with the URLs you pass in, libcurl offers ways for you to specify which HTTP version to use. libcurl is designed in a way so that it tries to use the most common, the most sensible if you want, default values first but sometimes that is not enough and then you may need to instruct libcurl what to do.</p>
<p>libcurl defaults to using HTTP/2 for HTTPS servers if you use a libcurl build with HTTP/2 abilities built-in. libcurl then attempts to use HTTP/2 automatically or falls back to 1.1 in case the negotiation failed. Non-HTTP/2 capable libcurls use HTTP/1.1 over HTTPS by default. Plain HTTP requests default to HTTP/1.1.</p>
<p>If the default behavior is not good enough for your transfer, the <code>CURLOPT_HTTP_VERSION</code> option is there for you.</p>
<table>
<colgroup>
<col style="width: 74%" />
<col style="width: 26%" />
</colgroup>
<thead>
<tr class="header">
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>CURL_HTTP_VERSION_NONE</td>
<td>Reset back to default behavior</td>
</tr>
<tr class="even">
<td>CURL_HTTP_VERSION_1_0</td>
<td>Enforce use of the legacy HTTP/1.0 protocol version</td>
</tr>
<tr class="odd">
<td>CURL_HTTP_VERSION_1_1</td>
<td>Do the request using the HTTP/1.1 protocol version</td>
</tr>
<tr class="even">
<td>CURL_HTTP_VERSION_2_0</td>
<td>Attempt to use HTTP/2</td>
</tr>
<tr class="odd">
<td>CURL_HTTP_VERSION_2TLS</td>
<td>Attempt to use HTTP/2 on HTTPS connections only, otherwise do HTTP/1.1</td>
</tr>
<tr class="even">
<td>CURL_HTTP_VERSION_2_PRIOR_KNOWLEDGE</td>
<td>Use HTTP/2 straight away without “upgrading” from 1.1. It requires that you know that this server is OK with it.</td>
</tr>
<tr class="odd">
<td>CURL_HTTP_VERSION_3</td>
<td>Try HTTP/3, allow fallback to older version.</td>
</tr>
<tr class="even">
<td>CURL_HTTP_VERSION_3ONLY</td>
<td>Use HTTP/3 or fail if not possible</td>
</tr>
</tbody>
</table>
<section id="libcurl-http__versions__md-_-_-version-2-not-mandatory" class="level2" data-number="247.1">
<h2 data-number="247.1">Version 2 not mandatory</h2>
<p>When asking libcurl to use HTTP/2, it is an ask not a requirement. libcurl then allows the server to select to use HTTP/1.1 or HTTP/2 and that is what decides which protocol that is ultimately used.</p>
</section>
<section id="libcurl-http__versions__md-_-_-version-3-can-be-mandatory" class="level2" data-number="247.2">
<h2 data-number="247.2">Version 3 can be mandatory</h2>
<p>When asking libcurl to use HTTP/3 with the <code>CURL_HTTP_VERSION_3</code> option, it makes libcurl do a second connection attempt in parallel but slightly delayed, so that if the HTTP/3 connection fails, it can still try and use an older HTTP version.</p>
<p>Using <code>CURL_HTTP_VERSION_3ONLY</code> means that the fallback mechanism is not used and a failed QUIC connection fails the transfer completely.</p>
<p><span id="libcurl-http__ranges__md"></span></p>
</section>
</section>
</body>
</html>
